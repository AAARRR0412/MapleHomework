<ui:FluentWindow x:Class="MapleHomework.BossRewardWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
        xmlns:converters="clr-namespace:MapleHomework.Converters"
        Title="보스 수익 계산기" 
        Height="1000" Width="1100"
        WindowStartupLocation="CenterScreen"
        ExtendsContentIntoTitleBar="True"
        WindowBackdropType="Mica"
        ResizeMode="NoResize"
        Background="{DynamicResource WindowBackground}">
    
    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVis"/>
        <converters:DifficultyColorConverter x:Key="DifficultyColorConverter"/>
        
        <!-- 보스 수익 계산기 전용 ComboBox 스타일 (드롭다운 배경 포함) -->
        <Style x:Key="BossRewardComboBoxStyle" TargetType="ComboBox" BasedOn="{StaticResource {x:Type ComboBox}}">
            <Setter Property="Background" Value="{DynamicResource CardBackground}"/>
            <Setter Property="Foreground" Value="{DynamicResource TextPrimary}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource BorderColor}"/>
            <Setter Property="FontFamily" Value="{StaticResource PretendardFont}"/>
        </Style>
    </Window.Resources>
    
    <Grid x:Name="MainGrid" Background="{DynamicResource WindowBackground}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        
        <!-- 모던 타이틀 바 -->
        <Border x:Name="TitleBarBorder" Grid.Row="0" Background="{DynamicResource CardBackground}" 
                BorderBrush="{DynamicResource BorderColor}" BorderThickness="0,0,0,1"
                Padding="24,16" MouseLeftButtonDown="TitleBar_MouseLeftButtonDown">
            <Grid>
                <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                    <Border Background="#15FFD700" CornerRadius="12" Padding="12" Margin="0,0,16,0">
                        <ui:SymbolIcon Symbol="Money24" FontSize="24" Foreground="#FFD700"/>
                    </Border>
                    <StackPanel VerticalAlignment="Center">
                        <TextBlock Text="보스 수익 계산기" Foreground="{DynamicResource TextPrimary}" 
                                   FontSize="20" FontWeight="Bold"/>
                        <TextBlock x:Name="TxtTotalCharacters" Text="총 0개 캐릭터" 
                                   Foreground="{DynamicResource TextMuted}" FontSize="12" Margin="0,2,0,0"/>
                    </StackPanel>
                </StackPanel>
                
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Center">
                    <Button Click="MinimizeButton_Click" Width="40" Height="40" Padding="0"
                            Background="Transparent" BorderThickness="0" Cursor="Hand" ToolTip="최소화">
                        <ui:SymbolIcon Symbol="Subtract24" FontSize="18" Foreground="{DynamicResource TextMuted}"/>
                    </Button>
                    <Button Click="CloseButton_Click" Width="40" Height="40" Padding="0"
                            Background="Transparent" BorderThickness="0" Cursor="Hand" ToolTip="닫기">
                        <ui:SymbolIcon Symbol="Dismiss24" FontSize="18" Foreground="{DynamicResource TextMuted}"/>
                    </Button>
                </StackPanel>
            </Grid>
        </Border>
        
        <!-- 메인 컨텐츠 -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Padding="24,20">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="360"/>
                </Grid.ColumnDefinitions>
                
                <!-- 왼쪽: 보스 수익 목록 -->
                <Border Grid.Column="0" Background="{DynamicResource CardBackground}" 
                        CornerRadius="16" Margin="0,0,16,0"
                        BorderBrush="{DynamicResource BorderColor}" BorderThickness="1">
                    <Border.Effect>
                        <DropShadowEffect BlurRadius="20" ShadowDepth="0" Opacity="0.08"/>
                    </Border.Effect>
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        
                        <!-- 헤더 -->
                        <Border Grid.Row="0" CornerRadius="16,16,0,0">
                            <Border.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                    <GradientStop Color="#FF3B30" Offset="0"/>
                                    <GradientStop Color="#FF6B6B" Offset="1"/>
                                </LinearGradientBrush>
                            </Border.Background>
                            <Grid Margin="20,16">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <StackPanel Orientation="Horizontal">
                                    <Border Background="#20FFFFFF" CornerRadius="8" Padding="8" Margin="0,0,14,0">
                                        <ui:SymbolIcon Symbol="Shield24" FontSize="20" Foreground="White"/>
                                    </Border>
                                    <StackPanel VerticalAlignment="Center">
                                        <TextBlock Text="주간 보스 수익" Foreground="White" FontSize="17" FontWeight="Bold"/>
                                        <TextBlock Text="파티 설정이 적용된 개인 수익" Foreground="#C0FFFFFF" FontSize="11" Margin="0,2,0,0"/>
                                    </StackPanel>
                                </StackPanel>
                                <Border Grid.Column="1" Background="#30FFFFFF" CornerRadius="8" Padding="12,6" VerticalAlignment="Center">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock x:Name="TxtCompletedBossCount" Text="0/12" Foreground="White" FontWeight="Bold" FontSize="14"/>
                                        <TextBlock Text=" 완료" Foreground="#C0FFFFFF" FontSize="12" VerticalAlignment="Center"/>
                                    </StackPanel>
                                </Border>
                            </Grid>
                        </Border>
                        
                        <!-- 보스 목록 -->
                        <ItemsControl x:Name="BossRewardList" Grid.Row="1" Margin="16">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border CornerRadius="12" Padding="16,14" Margin="0,0,0,10"
                                                Background="{DynamicResource ItemCardBackground}"
                                                BorderBrush="{DynamicResource ItemCardBorder}" BorderThickness="1">
                                            <Border.Style>
                                                <Style TargetType="Border">
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding IsChecked}" Value="True">
                                                            <Setter Property="Background">
                                                                <Setter.Value>
                                                                    <SolidColorBrush Color="#1510B981"/>
                                                                </Setter.Value>
                                                            </Setter>
                                                            <Setter Property="BorderBrush">
                                                                <Setter.Value>
                                                                    <SolidColorBrush Color="#3010B981"/>
                                                                </Setter.Value>
                                                            </Setter>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Border.Style>
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                
                                                <!-- 체크 표시 -->
                                                <Border Grid.Column="0" Width="32" Height="32" CornerRadius="16" 
                                                        Margin="0,0,14,0" VerticalAlignment="Center">
                                                    <Border.Style>
                                                        <Style TargetType="Border">
                                                            <Setter Property="Background" Value="{DynamicResource DividerColor}"/>
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding IsChecked}" Value="True">
                                                                    <Setter Property="Background" Value="#10B981"/>
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </Border.Style>
                                                    <ui:SymbolIcon Symbol="Checkmark16" FontSize="16" Foreground="White"
                                                                   Visibility="{Binding CheckVisibility}"
                                                                   HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                </Border>
                                                
                                                <!-- 보스 이름 + 난이도 -->
                                                <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,6">
                                                        <!-- 메인 UI와 동일한 난이도 뱃지 스타일 -->
                                                        <Border CornerRadius="4" Padding="6,2" Margin="0,0,10,0" MinWidth="50"
                                                                Background="{Binding Difficulty, Converter={StaticResource DifficultyColorConverter}}">
                                                            <Border.Style>
                                                                <Style TargetType="Border">
                                                                    <Style.Triggers>
                                                                        <DataTrigger Binding="{Binding Difficulty}" Value="Chaos">
                                                                            <Setter Property="Background" Value="#2A2A2A"/>
                                                                            <Setter Property="BorderBrush" Value="#E8DCCA"/>
                                                                            <Setter Property="BorderThickness" Value="1"/>
                                                                        </DataTrigger>
                                                                        <DataTrigger Binding="{Binding Difficulty}" Value="Extreme">
                                                                            <Setter Property="Background">
                                                                                <Setter.Value>
                                                                                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                                                                        <GradientStop Color="#1a1a1a" Offset="0"/>
                                                                                        <GradientStop Color="#4a0080" Offset="0.5"/>
                                                                                        <GradientStop Color="#1a1a1a" Offset="1"/>
                                                                                    </LinearGradientBrush>
                                                                                </Setter.Value>
                                                                            </Setter>
                                                                            <Setter Property="BorderBrush" Value="#9400D3"/>
                                                                            <Setter Property="BorderThickness" Value="1"/>
                                                                        </DataTrigger>
                                                                    </Style.Triggers>
                                                                </Style>
                                                            </Border.Style>
                                                            <TextBlock Text="{Binding DifficultyText}" FontSize="11" FontWeight="Bold" 
                                                                       HorizontalAlignment="Center">
                                                                <TextBlock.Style>
                                                                    <Style TargetType="TextBlock">
                                                                        <Setter Property="Foreground" Value="White"/>
                                                                        <Style.Triggers>
                                                                            <DataTrigger Binding="{Binding Difficulty}" Value="Chaos">
                                                                                <Setter Property="Foreground" Value="#E8DCCA"/>
                                                                            </DataTrigger>
                                                                            <DataTrigger Binding="{Binding Difficulty}" Value="Extreme">
                                                                                <Setter Property="Foreground">
                                                                                    <Setter.Value>
                                                                                        <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                                                                            <GradientStop Color="#FF00FF" Offset="0"/>
                                                                                            <GradientStop Color="#9400D3" Offset="0.5"/>
                                                                                            <GradientStop Color="#FF00FF" Offset="1"/>
                                                                                        </LinearGradientBrush>
                                                                                    </Setter.Value>
                                                                                </Setter>
                                                                            </DataTrigger>
                                                                        </Style.Triggers>
                                                                    </Style>
                                                                </TextBlock.Style>
                                                            </TextBlock>
                                                        </Border>
                                                        <TextBlock Text="{Binding DisplayName}" Foreground="{DynamicResource TextPrimary}" 
                                                                   FontSize="15" FontWeight="SemiBold" VerticalAlignment="Center">
                                                            <TextBlock.Style>
                                                                <Style TargetType="TextBlock">
                                                                    <Style.Triggers>
                                                                        <DataTrigger Binding="{Binding IsChecked}" Value="True">
                                                                            <Setter Property="Opacity" Value="0.6"/>
                                                                        </DataTrigger>
                                                                    </Style.Triggers>
                                                                </Style>
                                                            </TextBlock.Style>
                                                        </TextBlock>
                                                    </StackPanel>
                                                    <StackPanel Orientation="Horizontal">
                                                        <Border Background="{DynamicResource BadgeBackground}" CornerRadius="4" Padding="6,2">
                                                            <TextBlock Text="{Binding PartyInfoText}" Foreground="{DynamicResource TextMuted}" FontSize="11"/>
                                                        </Border>
                                                    </StackPanel>
                                                </StackPanel>
                                                
                                                <!-- 개인 수익 -->
                                                <StackPanel Grid.Column="2" VerticalAlignment="Center" HorizontalAlignment="Right">
                                                    <TextBlock Text="{Binding PersonalRewardText}" FontSize="18" FontWeight="Bold" HorizontalAlignment="Right">
                                                        <TextBlock.Style>
                                                            <Style TargetType="TextBlock">
                                                                <Setter Property="Foreground" Value="#FFD700"/>
                                                                <Style.Triggers>
                                                                    <DataTrigger Binding="{Binding IsChecked}" Value="True">
                                                                        <Setter Property="Foreground" Value="#10B981"/>
                                                                    </DataTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </TextBlock.Style>
                                                    </TextBlock>
                                                    <TextBlock Text="{Binding TotalRewardText}" Foreground="{DynamicResource TextMuted}" 
                                                               FontSize="11" HorizontalAlignment="Right" Margin="0,4,0,0"
                                                               Visibility="{Binding ShowTotalReward}"/>
                                                </StackPanel>
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                    </Grid>
                </Border>
                
                <!-- 오른쪽: 요약 정보 -->
                <StackPanel Grid.Column="1">
                    <!-- 캐릭터 선택 카드 -->
                    <Border x:Name="CharacterSelectBorder" Background="{DynamicResource CardBackground}" 
                            CornerRadius="16" Padding="20" Margin="0,0,0,16"
                            BorderBrush="{DynamicResource BorderColor}" BorderThickness="1">
                        <Border.Effect>
                            <DropShadowEffect BlurRadius="20" ShadowDepth="0" Opacity="0.08"/>
                        </Border.Effect>
                        <StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                                <ui:SymbolIcon Symbol="Person24" FontSize="18" Foreground="{DynamicResource AccentCyan}" Margin="0,0,10,0"/>
                                <TextBlock x:Name="CharacterSelectLabel" Text="캐릭터 선택" FontSize="14" FontWeight="SemiBold"
                                           Foreground="{DynamicResource TextPrimary}"/>
                            </StackPanel>
                            <ComboBox x:Name="CmbCharacter" SelectionChanged="CmbCharacter_SelectionChanged" 
                                      Style="{StaticResource BossRewardComboBoxStyle}" Padding="12,10">
                                <ComboBox.ItemContainerStyle>
                                    <Style TargetType="ComboBoxItem">
                                        <Setter Property="Background" Value="{DynamicResource CardBackground}"/>
                                        <Setter Property="Foreground" Value="{DynamicResource TextPrimary}"/>
                                        <Setter Property="FontFamily" Value="{StaticResource PretendardFont}"/>
                                        <Setter Property="Padding" Value="8,6"/>
                                        <Style.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter Property="Background" Value="{DynamicResource CardBackgroundHover}"/>
                                            </Trigger>
                                            <Trigger Property="IsSelected" Value="True">
                                                <Setter Property="Background" Value="{DynamicResource AccentCyan}"/>
                                                <Setter Property="Foreground" Value="White"/>
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </ComboBox.ItemContainerStyle>
                                <ComboBox.ItemTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="{Binding Nickname}" FontWeight="Medium"/>
                                            <TextBlock Text=" - Lv."/>
                                            <TextBlock Text="{Binding Level}"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </ComboBox.ItemTemplate>
                            </ComboBox>
                        </StackPanel>
                    </Border>
                    
                    <!-- 주간 수익 요약 카드 -->
                    <Border x:Name="WeeklyRewardBorder" Background="{DynamicResource CardBackground}" 
                            CornerRadius="16" Padding="20" Margin="0,0,0,16"
                            BorderBrush="{DynamicResource BorderColor}" BorderThickness="1">
                        <Border.Effect>
                            <DropShadowEffect BlurRadius="20" ShadowDepth="0" Opacity="0.08"/>
                        </Border.Effect>
                        <StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                                <ui:SymbolIcon Symbol="CalendarWeekNumbers24" FontSize="18" Foreground="#FF9500" Margin="0,0,10,0"/>
                                <TextBlock Text="주간 수익" FontSize="14" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimary}"/>
                            </StackPanel>
                            
                            <Border CornerRadius="12" Padding="16" Margin="0,0,0,12">
                                <Border.Background>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                        <GradientStop Color="#15FF3B30" Offset="0"/>
                                        <GradientStop Color="#10FF6B6B" Offset="1"/>
                                    </LinearGradientBrush>
                                </Border.Background>
                                <StackPanel>
                                    <TextBlock Text="획득한 수익" Foreground="#FF6B6B" FontSize="12"/>
                                    <TextBlock x:Name="TxtWeeklyBossReward" Text="0 메소" Foreground="#FF3B30" 
                                               FontSize="20" FontWeight="Bold" Margin="0,4,0,0"/>
                                </StackPanel>
                            </Border>
                            
                            <Border CornerRadius="12" Padding="16">
                                <Border.Background>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                        <GradientStop Color="#1510B981" Offset="0"/>
                                        <GradientStop Color="#1034D399" Offset="1"/>
                                    </LinearGradientBrush>
                                </Border.Background>
                                <StackPanel>
                                    <TextBlock Text="예상 수익" Foreground="#34D399" FontSize="12"/>
                                    <TextBlock x:Name="TxtWeeklyBossRewardShort" Text="0억" Foreground="#10B981" 
                                               FontSize="20" FontWeight="Bold" Margin="0,4,0,0"/>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </Border>
                    
                    <!-- 월간 수익 요약 카드 -->
                    <Border x:Name="MonthlyRewardBorder" Background="{DynamicResource CardBackground}" 
                            CornerRadius="16" Padding="20" Margin="0,0,0,16"
                            BorderBrush="{DynamicResource BorderColor}" BorderThickness="1">
                        <Border.Effect>
                            <DropShadowEffect BlurRadius="20" ShadowDepth="0" Opacity="0.08"/>
                        </Border.Effect>
                        <StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                                <ui:SymbolIcon Symbol="CalendarMonth24" FontSize="18" Foreground="#AF52DE" Margin="0,0,10,0"/>
                                <TextBlock Text="월간 수익" FontSize="14" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimary}"/>
                            </StackPanel>
                            
                            <Border CornerRadius="12" Padding="16" Margin="0,0,0,12">
                                <Border.Background>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                        <GradientStop Color="#15AF52DE" Offset="0"/>
                                        <GradientStop Color="#10C084FC" Offset="1"/>
                                    </LinearGradientBrush>
                                </Border.Background>
                                <StackPanel>
                                    <TextBlock Text="획득한 수익" Foreground="#C084FC" FontSize="12"/>
                                    <TextBlock x:Name="TxtMonthlyBossReward" Text="0" Foreground="#AF52DE" 
                                               FontSize="20" FontWeight="Bold" Margin="0,4,0,0"/>
                                </StackPanel>
                            </Border>
                            
                            <Border CornerRadius="12" Padding="16">
                                <Border.Background>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                        <GradientStop Color="#155AC8FA" Offset="0"/>
                                        <GradientStop Color="#1038BDF8" Offset="1"/>
                                    </LinearGradientBrush>
                                </Border.Background>
                                <StackPanel>
                                    <TextBlock Text="예상 수익" Foreground="#38BDF8" FontSize="12"/>
                                    <TextBlock x:Name="TxtMonthlyBossExpected" Text="0" Foreground="#5AC8FA" 
                                               FontSize="20" FontWeight="Bold" Margin="0,4,0,0"/>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </Border>
                    
                    <!-- 전체 캐릭터 총 수익 -->
                    <Border CornerRadius="16" Padding="24">
                        <Border.Background>
                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                <GradientStop Color="#5AC8FA" Offset="0"/>
                                <GradientStop Color="#818CF8" Offset="0.5"/>
                                <GradientStop Color="#A78BFA" Offset="1"/>
                            </LinearGradientBrush>
                        </Border.Background>
                        <Border.Effect>
                            <DropShadowEffect BlurRadius="25" ShadowDepth="0" Opacity="0.3" Color="#5AC8FA"/>
                        </Border.Effect>
                        <StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                                <ui:SymbolIcon Symbol="Trophy24" FontSize="20" Foreground="White" Margin="0,0,10,0"/>
                                <TextBlock Text="전체 캐릭터 합산" Foreground="White" FontSize="14" FontWeight="SemiBold" Opacity="0.9"/>
                            </StackPanel>
                            
                            <Border Height="1" Background="#30FFFFFF" Margin="0,0,0,16"/>
                            
                            <StackPanel Margin="0,0,0,16">
                                <TextBlock Text="주간 획득 수익" Foreground="White" FontSize="12" Opacity="0.8"/>
                                <TextBlock x:Name="TxtTotalWeeklyReward" Text="0억 메소" Foreground="White" 
                                           FontSize="26" FontWeight="Bold" Margin="0,4,0,0"/>
                            </StackPanel>
                            
                            <StackPanel>
                                <TextBlock Text="주간 예상 수익" Foreground="White" FontSize="12" Opacity="0.8"/>
                                <TextBlock x:Name="TxtTotalWeeklyExpected" Text="0억 메소" Foreground="White" 
                                           FontSize="26" FontWeight="Bold" Margin="0,4,0,0"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </Grid>
        </ScrollViewer>
    </Grid>
</ui:FluentWindow>
