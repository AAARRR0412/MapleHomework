<Window x:Class="MapleHomework.SidebarWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
        xmlns:converters="clr-namespace:MapleHomework.Converters"
        Title="Sidebar"
        Width="290" Height="900"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        ShowInTaskbar="False"
        ResizeMode="NoResize"
        Topmost="True">
    
    <Window.Resources>
        <converters:ProgressToWidthConverter x:Key="ProgressToWidthConverter"/>
    </Window.Resources>
    
    <!-- 사이드바 컨텐츠 -->
    <Border Background="#2D3748" CornerRadius="12,0,0,12" Margin="10,10,0,10">
        <Border.Effect>
            <DropShadowEffect BlurRadius="16" ShadowDepth="0" Opacity="0.3"/>
        </Border.Effect>
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- 사이드바 헤더 -->
            <Border Grid.Row="0" Padding="16,14" CornerRadius="12,0,0,0">
                <Border.Background>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                        <GradientStop Color="#5AC8FA" Offset="0"/>
                        <GradientStop Color="#818CF8" Offset="1"/>
                    </LinearGradientBrush>
                </Border.Background>
                <Grid>
                    <StackPanel Orientation="Horizontal">
                        <ui:SymbolIcon Symbol="People24" FontSize="18" Foreground="White" Margin="0,0,10,0"/>
                        <TextBlock Text="전체 캐릭터 현황" Foreground="White" FontSize="14" FontWeight="Bold" VerticalAlignment="Center"/>
                    </StackPanel>
                    <!-- 닫기 버튼 -->
                    <Button x:Name="CloseButton" Click="CloseButton_Click" 
                            HorizontalAlignment="Right" VerticalAlignment="Center"
                            Width="28" Height="28" Padding="0"
                            Background="Transparent" BorderThickness="0" Cursor="Hand">
                        <ui:SymbolIcon Symbol="Dismiss16" FontSize="14" Foreground="White"/>
                    </Button>
                </Grid>
            </Border>

            <!-- 캐릭터 숙제 게이지 목록 -->
            <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Padding="8">
                <ItemsControl x:Name="CharacterList">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Border Background="#374151" CornerRadius="10" Padding="12,10" Margin="0,0,0,8" Cursor="Hand"
                                    MouseLeftButtonDown="CharacterItem_Click">
                                <Border.Style>
                                    <Style TargetType="Border">
                                        <Style.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter Property="Background" Value="#4B5563"/>
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </Border.Style>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>

                                    <!-- 캐릭터 이미지 -->
                                    <Border Width="44" Height="44" CornerRadius="22" ClipToBounds="True">
                                        <Border.Background>
                                            <ImageBrush Stretch="UniformToFill"
                                                        ImageSource="{Binding ImageUrl, TargetNullValue={x:Null}, FallbackValue={x:Null}}">
                                                <ImageBrush.RelativeTransform>
                                                    <ScaleTransform CenterX="0.5" CenterY="0.55" ScaleX="3.5" ScaleY="3.5"/>
                                                </ImageBrush.RelativeTransform>
                                            </ImageBrush>
                                        </Border.Background>
                                    </Border>

                                    <!-- 캐릭터 정보 + 게이지 -->
                                    <StackPanel Grid.Column="1" Margin="10,0,0,0">
                                        <Grid>
                                            <TextBlock Text="{Binding Nickname}" Foreground="White" FontSize="13" FontWeight="SemiBold"/>
                                            <TextBlock Text="{Binding Level, StringFormat='Lv.{0}'}" Foreground="#5AC8FA" 
                                                       FontSize="10" HorizontalAlignment="Right"/>
                                        </Grid>
                                        
                                        <!-- 일일 게이지 -->
                                        <Grid Margin="0,8,0,0">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="28"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="32"/>
                                            </Grid.ColumnDefinitions>
                                            <TextBlock Text="일일" Foreground="#5AC8FA" FontSize="9" FontWeight="Bold" VerticalAlignment="Center"/>
                                            <Border Grid.Column="1" Height="6" CornerRadius="3" Background="#1F2937">
                                                <Border CornerRadius="3" HorizontalAlignment="Left"
                                                        Width="{Binding DailyProgress, Converter={StaticResource ProgressToWidthConverter}}">
                                                    <Border.Background>
                                                        <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                                            <GradientStop Color="#5AC8FA" Offset="0"/>
                                                            <GradientStop Color="#4ECDC4" Offset="1"/>
                                                        </LinearGradientBrush>
                                                    </Border.Background>
                                                </Border>
                                            </Border>
                                            <TextBlock Grid.Column="2" Text="{Binding DailyProgress, StringFormat='{}{0:F0}%'}" 
                                                       Foreground="#5AC8FA" FontSize="9" FontWeight="Bold" HorizontalAlignment="Right" VerticalAlignment="Center"/>
                                        </Grid>
                                        
                                        <!-- 주간 게이지 -->
                                        <Grid Margin="0,5,0,0">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="28"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="32"/>
                                            </Grid.ColumnDefinitions>
                                            <TextBlock Text="주간" Foreground="#FF9500" FontSize="9" FontWeight="Bold" VerticalAlignment="Center"/>
                                            <Border Grid.Column="1" Height="6" CornerRadius="3" Background="#1F2937">
                                                <Border CornerRadius="3" HorizontalAlignment="Left"
                                                        Width="{Binding WeeklyProgress, Converter={StaticResource ProgressToWidthConverter}}">
                                                    <Border.Background>
                                                        <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                                            <GradientStop Color="#FF9500" Offset="0"/>
                                                            <GradientStop Color="#FFCC00" Offset="1"/>
                                                        </LinearGradientBrush>
                                                    </Border.Background>
                                                </Border>
                                            </Border>
                                            <TextBlock Grid.Column="2" Text="{Binding WeeklyProgress, StringFormat='{}{0:F0}%'}" 
                                                       Foreground="#FF9500" FontSize="9" FontWeight="Bold" HorizontalAlignment="Right" VerticalAlignment="Center"/>
                                        </Grid>
                                        
                                        <!-- 보스 게이지 -->
                                        <Grid Margin="0,5,0,0">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="28"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="32"/>
                                            </Grid.ColumnDefinitions>
                                            <TextBlock Text="보스" Foreground="#FF3B30" FontSize="9" FontWeight="Bold" VerticalAlignment="Center"/>
                                            <Border Grid.Column="1" Height="6" CornerRadius="3" Background="#1F2937">
                                                <Border CornerRadius="3" HorizontalAlignment="Left"
                                                        Width="{Binding BossProgress, Converter={StaticResource ProgressToWidthConverter}}">
                                                    <Border.Background>
                                                        <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                                            <GradientStop Color="#FF3B30" Offset="0"/>
                                                            <GradientStop Color="#FF6B6B" Offset="1"/>
                                                        </LinearGradientBrush>
                                                    </Border.Background>
                                                </Border>
                                            </Border>
                                            <TextBlock Grid.Column="2" Text="{Binding BossProgress, StringFormat='{}{0:F0}%'}" 
                                                       Foreground="#FF3B30" FontSize="9" FontWeight="Bold" HorizontalAlignment="Right" VerticalAlignment="Center"/>
                                        </Grid>
                                    </StackPanel>
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </ScrollViewer>
        </Grid>
    </Border>
</Window>

