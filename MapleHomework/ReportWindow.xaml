<ui:FluentWindow x:Class="MapleHomework.ReportWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
        xmlns:converters="clr-namespace:MapleHomework.Converters"
        Title="통계 리포트" 
        Height="950" Width="1400"
        WindowStartupLocation="CenterScreen"
        ResizeMode="NoResize"
        ExtendsContentIntoTitleBar="True"
        WindowBackdropType="Mica"
        UseLayoutRounding="True">

    <Window.Resources>
        <!-- 테마 리소스는 ThemeService (App.xaml)에서 관리 -->

        <converters:JsonToItemInfoConverter x:Key="JsonToItemInfoConverter"/>
        <converters:StringNotEmptyToBoolConverter x:Key="StringNotEmptyToBoolConverter"/>
        <converters:RateToWidthConverter x:Key="RateToWidthConverter"/>
        <converters:StarRepeatConverter x:Key="StarRepeatConverter"/>
        <converters:StatDeltaConverter x:Key="StatDeltaConverter"/>
        <converters:ItemTooltipImageConverter x:Key="ItemTooltipImageConverter"/>
        <converters:InverseBoolToVisConverter x:Key="BoolToVisibilityInverse"/>
        <converters:CountToVisibilityInverseConverter x:Key="CountToVisibilityInverse"/>
        <BooleanToVisibilityConverter x:Key="BoolToVisibility"/>

        <Style x:Key="ItemTooltipStyle" TargetType="ToolTip">
            <Setter Property="OverridesDefaultStyle" Value="True"/>
            <Setter Property="HasDropShadow" Value="True"/>
            <Setter Property="FontFamily" Value="돋움"/>
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="MinWidth" Value="324"/>
            <Setter Property="MaxWidth" Value="340"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ToolTip">
                        <Border CornerRadius="0"
                                Background="#F0181D28"
                                BorderBrush="#80506070"
                                BorderThickness="1"
                                Padding="15,10"
                                MaxWidth="{TemplateBinding MaxWidth}"
                                MinWidth="{TemplateBinding MinWidth}">
                            <Border.Effect>
                                <DropShadowEffect BlurRadius="8" ShadowDepth="2" Opacity="0.4" Color="#000000"/>
                            </Border.Effect>
                            <ContentPresenter />
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <DataTemplate x:Key="ItemTooltipTemplate">
            <StackPanel DataContext="{Binding}">
                <TextBlock HorizontalAlignment="Center" Margin="0,0,0,4" FontFamily="Segoe UI Symbol">
                    <Run Text="{Binding Starforce, Converter={StaticResource StarRepeatConverter}, ConverterParameter=all}" 
                         Foreground="#FFCC00" FontSize="10"/>
                </TextBlock>
                <TextBlock Text="{Binding ItemName}" 
                           Foreground="#FFFFFF" FontSize="14" FontWeight="Bold" 
                           HorizontalAlignment="Center" Margin="0,0,0,2"
                           TextWrapping="Wrap" TextAlignment="Center"/>
                
                <TextBlock Text="교환 불가" 
                           Foreground="#FF8A18" FontSize="11" 
                           HorizontalAlignment="Center" Margin="0,0,0,4"/>

                <Rectangle Height="1" Fill="#40FFFFFF" Margin="0,4,0,8"/>
                
                <Grid Margin="0,0,0,6">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    
                    <Border Grid.Column="0" Width="72" Height="72" 
                            Background="#20303844"
                            BorderBrush="#30FFFFFF" BorderThickness="1"
                            Margin="0,0,10,0">
                        <Image Source="{Binding ItemIcon}" Stretch="Uniform" Margin="6"/>
                    </Border>
                    
                    <StackPanel Grid.Column="1" VerticalAlignment="Top">
                        <TextBlock Foreground="#85919F" FontSize="11" Margin="0,2,0,4" HorizontalAlignment="Right">
                            <Run Text="전투력 증가량"/>
                        </TextBlock>
                        <TextBlock Foreground="#FFCC00" FontSize="14" FontWeight="Bold" HorizontalAlignment="Right" Margin="0,0,0,10">
                            <Run Text="+0"/>
                        </TextBlock>
                    </StackPanel>
                </Grid>

                <Border Background="#25384858" Height="18" Margin="0,0,0,8">
                    <TextBlock Text="{Binding ItemEquipmentPart}" 
                               Foreground="#FFFFFF" FontSize="11" 
                               VerticalAlignment="Center" HorizontalAlignment="Center"/>
                </Border>

                <StackPanel Margin="0,0,0,6">
                    <TextBlock Foreground="#B7BFC5" FontSize="11" Margin="0,1">
                        <Run Text="REQ LEV : "/>
                        <Run Text="200" Foreground="#FFFFFF"/>
                    </TextBlock>
                </StackPanel>
                
                <Rectangle Height="1" Fill="#40FFFFFF" Margin="0,4,0,8"/>
                
                <StackPanel Margin="0,0,0,4">
                    <TextBlock FontSize="11" Margin="0,2">
                        <Run Text="STR : +" Foreground="#FFFFFF"/>
                        <Run Text="{Binding ItemTotalOption.Str}" Foreground="#FFFFFF"/>
                        <Run Text=" (" Foreground="#85919F"/>
                        <Run Text="{Binding ItemBaseOption.Str}" Foreground="#85919F"/>
                        <Run Foreground="#0AE3AD">
                            <Run.Text>
                                <MultiBinding Converter="{StaticResource StatDeltaConverter}">
                                    <Binding Path="ItemTotalOption.Str"/>
                                    <Binding Path="ItemBaseOption.Str"/>
                                </MultiBinding>
                            </Run.Text>
                        </Run>
                        <Run Text=")" Foreground="#85919F"/>
                    </TextBlock>
                    <TextBlock FontSize="11" Margin="0,2">
                        <Run Text="DEX : +" Foreground="#FFFFFF"/>
                        <Run Text="{Binding ItemTotalOption.Dex}" Foreground="#FFFFFF"/>
                        <Run Text=" (" Foreground="#85919F"/>
                        <Run Text="{Binding ItemBaseOption.Dex}" Foreground="#85919F"/>
                        <Run Foreground="#0AE3AD">
                            <Run.Text>
                                <MultiBinding Converter="{StaticResource StatDeltaConverter}">
                                    <Binding Path="ItemTotalOption.Dex"/>
                                    <Binding Path="ItemBaseOption.Dex"/>
                                </MultiBinding>
                            </Run.Text>
                        </Run>
                        <Run Text=")" Foreground="#85919F"/>
                    </TextBlock>
                    <TextBlock FontSize="11" Margin="0,2">
                        <Run Text="INT : +" Foreground="#FFFFFF"/>
                        <Run Text="{Binding ItemTotalOption.Int}" Foreground="#FFFFFF"/>
                        <Run Text=" (" Foreground="#85919F"/>
                        <Run Text="{Binding ItemBaseOption.Int}" Foreground="#85919F"/>
                        <Run Foreground="#0AE3AD">
                            <Run.Text>
                                <MultiBinding Converter="{StaticResource StatDeltaConverter}">
                                    <Binding Path="ItemTotalOption.Int"/>
                                    <Binding Path="ItemBaseOption.Int"/>
                                </MultiBinding>
                            </Run.Text>
                        </Run>
                        <Run Text=")" Foreground="#85919F"/>
                    </TextBlock>
                    <TextBlock FontSize="11" Margin="0,2">
                        <Run Text="LUK : +" Foreground="#FFFFFF"/>
                        <Run Text="{Binding ItemTotalOption.Luk}" Foreground="#FFFFFF"/>
                        <Run Text=" (" Foreground="#85919F"/>
                        <Run Text="{Binding ItemBaseOption.Luk}" Foreground="#85919F"/>
                        <Run Foreground="#0AE3AD">
                            <Run.Text>
                                <MultiBinding Converter="{StaticResource StatDeltaConverter}">
                                    <Binding Path="ItemTotalOption.Luk"/>
                                    <Binding Path="ItemBaseOption.Luk"/>
                                </MultiBinding>
                            </Run.Text>
                        </Run>
                        <Run Text=")" Foreground="#85919F"/>
                    </TextBlock>
                    <TextBlock FontSize="11" Margin="0,2">
                        <Run Text="최대 HP : +" Foreground="#FFFFFF"/>
                        <Run Text="{Binding ItemTotalOption.MaxHp}" Foreground="#FFFFFF"/>
                        <Run Text=" (" Foreground="#85919F"/>
                        <Run Text="{Binding ItemBaseOption.MaxHp}" Foreground="#85919F"/>
                        <Run Foreground="#0AE3AD">
                            <Run.Text>
                                <MultiBinding Converter="{StaticResource StatDeltaConverter}">
                                    <Binding Path="ItemTotalOption.MaxHp"/>
                                    <Binding Path="ItemBaseOption.MaxHp"/>
                                </MultiBinding>
                            </Run.Text>
                        </Run>
                        <Run Text=")" Foreground="#85919F"/>
                    </TextBlock>
                    <TextBlock FontSize="11" Margin="0,2">
                        <Run Text="공격력 : +" Foreground="#FFFFFF"/>
                        <Run Text="{Binding ItemTotalOption.AttackPower}" Foreground="#FFFFFF"/>
                        <Run Text=" (" Foreground="#85919F"/>
                        <Run Text="{Binding ItemBaseOption.AttackPower}" Foreground="#85919F"/>
                        <Run Foreground="#0AE3AD">
                            <Run.Text>
                                <MultiBinding Converter="{StaticResource StatDeltaConverter}">
                                    <Binding Path="ItemTotalOption.AttackPower"/>
                                    <Binding Path="ItemBaseOption.AttackPower"/>
                                </MultiBinding>
                            </Run.Text>
                        </Run>
                        <Run Text=")" Foreground="#85919F"/>
                    </TextBlock>
                    <TextBlock FontSize="11" Margin="0,2">
                        <Run Text="마력 : +" Foreground="#FFFFFF"/>
                        <Run Text="{Binding ItemTotalOption.MagicPower}" Foreground="#FFFFFF"/>
                        <Run Text=" (" Foreground="#85919F"/>
                        <Run Text="{Binding ItemBaseOption.MagicPower}" Foreground="#85919F"/>
                        <Run Foreground="#0AE3AD">
                            <Run.Text>
                                <MultiBinding Converter="{StaticResource StatDeltaConverter}">
                                    <Binding Path="ItemTotalOption.MagicPower"/>
                                    <Binding Path="ItemBaseOption.MagicPower"/>
                                </MultiBinding>
                            </Run.Text>
                        </Run>
                        <Run Text=")" Foreground="#85919F"/>
                    </TextBlock>
                    <TextBlock FontSize="11" Foreground="#FFCC00" Margin="0,2">
                        <Run Text="보스 몬스터 공격 시 데미지 : +"/>
                        <Run Text="{Binding ItemTotalOption.BossDamage}"/>
                        <Run Text="%"/>
                    </TextBlock>
                    <TextBlock FontSize="11" Foreground="#FFCC00" Margin="0,2">
                        <Run Text="몬스터 방어율 무시 : +"/>
                        <Run Text="{Binding ItemTotalOption.IgnoreMonsterArmor}"/>
                        <Run Text="%"/>
                    </TextBlock>
                </StackPanel>
                
                <Rectangle Height="1" Fill="#40FFFFFF" Margin="0,4,0,8"/>
                
                <StackPanel Margin="0,0,0,4">
                    <TextBlock FontSize="11" Foreground="#CCFF00" Margin="0,0,0,3">
                        <Run Text="잠재옵션 ("/>
                        <Run Text="{Binding PotentialOptionGrade}"/>
                        <Run Text=" 아이템)"/>
                    </TextBlock>
                    <TextBlock FontSize="11" Foreground="#FFFFFF" Margin="0,1">
                        <Run Text="{Binding PotentialOption1}"/>
                    </TextBlock>
                    <TextBlock FontSize="11" Foreground="#FFFFFF" Margin="0,1">
                        <Run Text="{Binding PotentialOption2}"/>
                    </TextBlock>
                    <TextBlock FontSize="11" Foreground="#FFFFFF" Margin="0,1">
                        <Run Text="{Binding PotentialOption3}"/>
                    </TextBlock>
                </StackPanel>
                
                <Rectangle Height="1" Fill="#40FFFFFF" Margin="0,4,0,8"/>
                
                <StackPanel>
                    <TextBlock FontSize="11" Foreground="#BB81FF" Margin="0,0,0,3">
                        <Run Text="에디셔널 잠재옵션 ("/>
                        <Run Text="{Binding AdditionalPotentialOptionGrade}"/>
                        <Run Text=" 아이템)"/>
                    </TextBlock>
                    <TextBlock FontSize="11" Foreground="#FFFFFF" Margin="0,1">
                        <Run Text="{Binding AdditionalPotentialOption1}"/>
                    </TextBlock>
                    <TextBlock FontSize="11" Foreground="#FFFFFF" Margin="0,1">
                        <Run Text="{Binding AdditionalPotentialOption2}"/>
                    </TextBlock>
                    <TextBlock FontSize="11" Foreground="#FFFFFF" Margin="0,1">
                        <Run Text="{Binding AdditionalPotentialOption3}"/>
                    </TextBlock>
                </StackPanel>
            </StackPanel>
        </DataTemplate>

        <Style x:Key="ModernCard" TargetType="Border">
            <Setter Property="Background" Value="{DynamicResource CardBackground}"/>
            <Setter Property="CornerRadius" Value="16"/>
            <Setter Property="Padding" Value="20"/>
            <Setter Property="BorderBrush" Value="{DynamicResource BorderColor}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect BlurRadius="16" ShadowDepth="0" Opacity="0.1" Color="#000000"/>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="MapleHeader" TargetType="Border">
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="14,8"/>
            <Setter Property="Background">
                <Setter.Value>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                        <GradientStop Color="#5AC8FA" Offset="0"/>
                        <GradientStop Color="#38BDF8" Offset="1"/>
                    </LinearGradientBrush>
                </Setter.Value>
            </Setter>
        </Style>

        <LinearGradientBrush x:Key="ExpGradient" StartPoint="0,1" EndPoint="0,0">
            <GradientStop Color="#667EEA" Offset="0"/>
            <GradientStop Color="#64B5F6" Offset="0.5"/>
            <GradientStop Color="#4DD0E1" Offset="1"/>
        </LinearGradientBrush>
        <LinearGradientBrush x:Key="UnionGradient" StartPoint="0,1" EndPoint="0,0">
            <GradientStop Color="#F093FB" Offset="0"/>
            <GradientStop Color="#F5576C" Offset="1"/>
        </LinearGradientBrush>
        <LinearGradientBrush x:Key="PowerGradient" StartPoint="0,1" EndPoint="0,0">
            <GradientStop Color="#FF6B6B" Offset="0"/>
            <GradientStop Color="#FFA726" Offset="1"/>
        </LinearGradientBrush>
    </Window.Resources>

        <Grid x:Name="MainGrid">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <Border Grid.Row="0" Padding="24,16" Background="Transparent" MouseLeftButtonDown="TitleBarBorder_MouseLeftButtonDown">
            <Grid>
                <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                    <Border Background="#5AC8FA" CornerRadius="10" Width="40" Height="40" Margin="0,0,14,0">
                        <ui:SymbolIcon Symbol="DataHistogram24" FontSize="22" Foreground="White"/>
                    </Border>
                    <StackPanel VerticalAlignment="Center">
                        <TextBlock x:Name="TitleText" Text="통계 리포트" Foreground="{DynamicResource TextPrimary}" 
                                   FontSize="20" FontWeight="SemiBold"/>
                        <TextBlock Text="캐릭터 성장 분석" Foreground="{DynamicResource TextSecondary}" 
                                   FontSize="12" Margin="0,2,0,0"/>
                    </StackPanel>
                </StackPanel>
                
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Center">
                    <Button Width="40" Height="40" Click="MinimizeButton_Click"
                            Background="Transparent" BorderThickness="0" Cursor="Hand" ToolTip="최소화">
                        <ui:SymbolIcon Symbol="Subtract24" FontSize="18" Foreground="{DynamicResource TextSecondary}"/>
                    </Button>
                    <Button Width="40" Height="40" Click="CloseButton_Click"
                            Background="Transparent" BorderThickness="0" Cursor="Hand" ToolTip="닫기">
                        <ui:SymbolIcon Symbol="Dismiss24" FontSize="18" Foreground="{DynamicResource TextSecondary}"/>
                    </Button>
                </StackPanel>
            </Grid>
        </Border>

        <Grid Grid.Row="1" Margin="20,0,20,20">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="240"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <Border Grid.Column="0" Style="{StaticResource ModernCard}" Margin="0,0,16,0">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <TextBlock Text="캐릭터 선택" Foreground="{DynamicResource TextSecondary}" FontSize="12" Margin="0,0,0,8"/>
                        <ComboBox x:Name="CharacterFilterCombo" SelectionChanged="CharacterFilterCombo_SelectionChanged" 
                                  Margin="0,0,0,15" Foreground="{DynamicResource TextPrimary}">
                            <ComboBox.ItemContainerStyle>
                                <Style TargetType="ComboBoxItem">
                                    <Setter Property="Foreground" Value="{DynamicResource TextPrimary}"/>
                                </Style>
                            </ComboBox.ItemContainerStyle>
                        </ComboBox>

                        <Border x:Name="ApiCollectCard" Background="{DynamicResource ApiCardBackground}" BorderBrush="{DynamicResource ApiCardBorder}"
                                BorderThickness="1" CornerRadius="10" Padding="12" Margin="0,0,0,15" ClipToBounds="True">
                            <!-- 아우터 글로우 효과용 - 더 진한 초록색 -->
                            <Border.Effect>
                                <DropShadowEffect x:Name="ApiCardGlow" BlurRadius="5" ShadowDepth="0" Opacity="0.3" Color="#00C853"/>
                            </Border.Effect>
                            <Grid>
                                <!-- 쉬머링(Sheen) 효과 레이어 - 더 밝고 선명하게 -->
                                <Rectangle x:Name="SheenRect" IsHitTestVisible="False" Opacity="0" Panel.ZIndex="5">
                                    <Rectangle.Fill>
                                        <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                            <GradientStop Color="Transparent" Offset="0"/>
                                            <GradientStop Color="#80FFFFFF" Offset="0.3"/>
                                            <GradientStop Color="#CCFFFFFF" Offset="0.5"/>
                                            <GradientStop Color="#80FFFFFF" Offset="0.7"/>
                                            <GradientStop Color="Transparent" Offset="1"/>
                                        </LinearGradientBrush>
                                    </Rectangle.Fill>
                                    <Rectangle.RenderTransform>
                                        <TranslateTransform x:Name="SheenTransform" X="-300"/>
                                    </Rectangle.RenderTransform>
                                </Rectangle>
                                
                                <!-- 파티클 캔버스 -->
                                <Canvas x:Name="ParticleCanvas" IsHitTestVisible="False" Panel.ZIndex="15"/>
                                
                                <!-- iOS 스타일 토스트 알림 -->
                                <Border x:Name="CollectCompleteOverlay" 
                                        Visibility="Collapsed" Panel.ZIndex="20"
                                        HorizontalAlignment="Center" VerticalAlignment="Center"
                                        Padding="16,10" CornerRadius="22"
                                        RenderTransformOrigin="0.5,0.5">
                                    <Border.Background>
                                        <SolidColorBrush Color="#1A1A1A" Opacity="0.92"/>
                                    </Border.Background>
                                    <Border.Effect>
                                        <DropShadowEffect BlurRadius="20" ShadowDepth="4" Opacity="0.35" Color="#000000"/>
                                    </Border.Effect>
                                    <Border.RenderTransform>
                                        <ScaleTransform x:Name="ToastScaleTransform" ScaleX="0.8" ScaleY="0.8"/>
                                    </Border.RenderTransform>
                                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                        <!-- 체크 아이콘 (원형 배경) -->
                                        <Border x:Name="ToastIconBorder" Width="28" Height="28" CornerRadius="14" Margin="0,0,10,0">
                                            <Border.Background>
                                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                                    <GradientStop Color="#34D399" Offset="0"/>
                                                    <GradientStop Color="#10B981" Offset="1"/>
                                                </LinearGradientBrush>
                                            </Border.Background>
                                            <TextBlock x:Name="ToastIcon" Text="✓" FontSize="16" FontWeight="Bold" 
                                                       Foreground="White" HorizontalAlignment="Center" VerticalAlignment="Center"
                                                       Margin="0,-1,0,0"/>
                                        </Border>
                                        <!-- 텍스트 -->
                                        <TextBlock x:Name="CollectCompleteText" Text="수집 완료!" 
                                                   FontSize="15" FontWeight="SemiBold" Foreground="White" 
                                                   VerticalAlignment="Center"/>
                                    </StackPanel>
                                </Border>
                                
                                <StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                        <ui:SymbolIcon Symbol="CloudArrowDown24" Foreground="{DynamicResource CalendarHeader}" FontSize="18"/>
                                        <TextBlock Text="API 데이터 수집" Foreground="{DynamicResource CalendarHeader}" 
                                                   FontSize="12" FontWeight="SemiBold" Margin="8,0,0,0" VerticalAlignment="Center"/>
                                    </StackPanel>
                                    
                                    <TextBlock x:Name="DataSummaryText" Text="0일" Visibility="Collapsed"/>
                                    <TextBlock x:Name="MissingDaysText" Text="0일" Visibility="Collapsed"/>
                                    
                                    <Grid Margin="0,0,0,6">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <Button x:Name="CalendarPrevMonth" Content="◀" Background="Transparent" 
                                                Foreground="{DynamicResource TextSecondary}" BorderThickness="0" 
                                                FontSize="10" Padding="6,2" Cursor="Hand" Click="CalendarPrevMonth_Click"/>
                                        <TextBlock x:Name="CalendarMonthText" Text="2024년 12월" Grid.Column="1" 
                                                   HorizontalAlignment="Center" VerticalAlignment="Center"
                                                   Foreground="{DynamicResource CalendarText}" FontSize="12" FontWeight="SemiBold"/>
                                        <Button x:Name="CalendarNextMonth" Content="▶" Grid.Column="2" Background="Transparent" 
                                                Foreground="{DynamicResource TextSecondary}" BorderThickness="0" 
                                                FontSize="10" Padding="6,2" Cursor="Hand" Click="CalendarNextMonth_Click"/>
                                    </Grid>
                                    
                                    <Grid Margin="0,0,0,2">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/><ColumnDefinition Width="*"/><ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/><ColumnDefinition Width="*"/><ColumnDefinition Width="*"/><ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="일" Grid.Column="0" HorizontalAlignment="Center" Foreground="{DynamicResource CalendarMissingBg}" FontSize="9" FontWeight="SemiBold"/>
                                        <TextBlock Text="월" Grid.Column="1" HorizontalAlignment="Center" Foreground="{DynamicResource TextMuted}" FontSize="9"/>
                                        <TextBlock Text="화" Grid.Column="2" HorizontalAlignment="Center" Foreground="{DynamicResource TextMuted}" FontSize="9"/>
                                        <TextBlock Text="수" Grid.Column="3" HorizontalAlignment="Center" Foreground="{DynamicResource TextMuted}" FontSize="9"/>
                                        <TextBlock Text="목" Grid.Column="4" HorizontalAlignment="Center" Foreground="{DynamicResource TextMuted}" FontSize="9"/>
                                        <TextBlock Text="금" Grid.Column="5" HorizontalAlignment="Center" Foreground="{DynamicResource TextMuted}" FontSize="9"/>
                                        <TextBlock Text="토" Grid.Column="6" HorizontalAlignment="Center" Foreground="{DynamicResource CalendarCollectedBg}" FontSize="9" FontWeight="SemiBold"/>
                                    </Grid>
                                    
                                    <Border Background="Transparent" CornerRadius="6" Padding="4" Margin="0,0,0,8">
                                        <UniformGrid x:Name="CalendarGrid" Rows="6" Columns="7"/>
                                    </Border>
                                    
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,0,0,8">
                                        <Border Background="{DynamicResource CalendarCollectedBg}" CornerRadius="3" Width="12" Height="12" Margin="0,0,4,0"/>
                                        <TextBlock Text="수집됨" Foreground="{DynamicResource TextMuted}" FontSize="9" Margin="0,0,10,0" VerticalAlignment="Center"/>
                                        <Border Background="{DynamicResource CalendarMissingBg}" CornerRadius="3" Width="12" Height="12" Margin="0,0,4,0"/>
                                        <TextBlock Text="누락" Foreground="{DynamicResource TextMuted}" FontSize="9" Margin="0,0,10,0" VerticalAlignment="Center"/>
                                        <Border Background="#10B981" CornerRadius="3" Width="12" Height="12" Margin="0,0,4,0"/>
                                        <TextBlock Text="선택됨" Foreground="{DynamicResource TextMuted}" FontSize="9" VerticalAlignment="Center"/>
                                    </StackPanel>
                                    
                                    <Border Background="{DynamicResource CardBackgroundAlt}" CornerRadius="6" Padding="10,8" Margin="0,0,0,8">
                                        <StackPanel>
                                            <TextBlock Text="선택된 날짜 :" Foreground="{DynamicResource TextMuted}" FontSize="11" Margin="0,0,0,6"/>
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="*"/>
                                                </Grid.ColumnDefinitions>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                </Grid.RowDefinitions>
                                                <TextBlock Text="시작 :" Foreground="{DynamicResource TextMuted}" FontSize="10" Grid.Row="0" Margin="0,0,8,2"/>
                                                <TextBlock x:Name="SelectedStartDateText" Text="-" Foreground="{DynamicResource AccentCyan}" 
                                                           FontSize="11" FontWeight="Bold" Grid.Row="0" Grid.Column="1"/>
                                                <TextBlock Text="끝 :" Foreground="{DynamicResource TextMuted}" FontSize="10" Grid.Row="1" Margin="0,2,8,0"/>
                                                <TextBlock x:Name="SelectedEndDateText" Text="-" Foreground="{DynamicResource AccentCyan}" 
                                                           FontSize="11" FontWeight="Bold" Grid.Row="1" Grid.Column="1" Margin="0,2,0,0"/>
                                            </Grid>
                                        </StackPanel>
                                    </Border>
                                    <TextBlock x:Name="SelectedDatesCountText" Visibility="Collapsed"/>
                                    
                                    <ui:Button x:Name="CollectHistoryButton" Content="선택한 날짜 수집" Icon="History24" 
                                               Appearance="Primary" HorizontalAlignment="Stretch"
                                               Click="CollectHistoryButton_Click" Height="36"/>
                                    
                                    <ProgressBar x:Name="CollectProgressBar" Height="4" Margin="0,10,0,0" 
                                                 Visibility="Collapsed" Foreground="{DynamicResource AccentCyan}"/>
                                    <TextBlock x:Name="CollectStatusText" Text="" Foreground="{DynamicResource TextPrimary}" 
                                               FontSize="10" Margin="0,5,0,0" TextAlignment="Center" TextWrapping="Wrap"/>
                                </StackPanel>
                            </Grid>
                        </Border>

                        <ui:Button Content="데이터 새로고침" Icon="ArrowSync24" 
                                   Appearance="Secondary" HorizontalAlignment="Stretch"
                                   Click="RefreshButton_Click" Height="32" Margin="0,0,0,6"/>

                        <ui:Button x:Name="ClearCacheButton" Content="데이터 삭제" Icon="Delete24"
                                   Appearance="Danger" HorizontalAlignment="Stretch" Foreground="White"
                                   Click="ClearCacheButton_Click" Height="32" Margin="0,0,0,16"/>
                        
                        <Border Height="1" Background="{DynamicResource DividerColor}" Margin="0,0,0,14"/>
                        
                        <TextBlock Text="바로가기" Foreground="{DynamicResource TextSecondary}" FontSize="11" FontWeight="SemiBold" Margin="0,0,0,10"/>
                        
                        <StackPanel>
                            <Button x:Name="NavExpPower" Click="NavExpPower_Click" Height="32" Margin="0,0,0,4" Cursor="Hand"
                                    HorizontalContentAlignment="Left" Background="Transparent" BorderThickness="0">
                                <StackPanel Orientation="Horizontal">
                                    <Border Width="4" Height="16" CornerRadius="2" Margin="0,0,8,0">
                                        <Border.Background>
                                            <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                                <GradientStop Color="#5AC8FA" Offset="0"/>
                                                <GradientStop Color="#4DD0E1" Offset="1"/>
                                            </LinearGradientBrush>
                                        </Border.Background>
                                    </Border>
                                    <TextBlock Text="경험치 / 전투력" Foreground="{DynamicResource TextPrimary}" FontSize="11"/>
                                </StackPanel>
                            </Button>
                            <Button x:Name="NavEquipment" Click="NavEquipment_Click" Height="32" Margin="0,0,0,4" Cursor="Hand"
                                    HorizontalContentAlignment="Left" Background="Transparent" BorderThickness="0">
                                <StackPanel Orientation="Horizontal">
                                    <Border Width="4" Height="16" CornerRadius="2" Margin="0,0,8,0">
                                        <Border.Background>
                                            <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                                <GradientStop Color="#FF9F43" Offset="0"/>
                                                <GradientStop Color="#FECA57" Offset="1"/>
                                            </LinearGradientBrush>
                                        </Border.Background>
                                    </Border>
                                    <TextBlock Text="장비 변경 내역" Foreground="{DynamicResource TextPrimary}" FontSize="11"/>
                                </StackPanel>
                            </Button>
                            <Button x:Name="NavHexaCore" Click="NavHexaCore_Click" Height="32" Margin="0,0,0,4" Cursor="Hand"
                                    HorizontalContentAlignment="Left" Background="Transparent" BorderThickness="0">
                                <StackPanel Orientation="Horizontal">
                                    <Border Width="4" Height="16" CornerRadius="2" Margin="0,0,8,0">
                                        <Border.Background>
                                            <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                                <GradientStop Color="#7C3AED" Offset="0"/>
                                                <GradientStop Color="#A855F7" Offset="1"/>
                                            </LinearGradientBrush>
                                        </Border.Background>
                                    </Border>
                                    <TextBlock Text="HEXA 코어 현황" Foreground="{DynamicResource TextPrimary}" FontSize="11"/>
                                </StackPanel>
                            </Button>
                            <Button x:Name="NavHexaSkill" Click="NavHexaSkill_Click" Height="32" Cursor="Hand"
                                    HorizontalContentAlignment="Left" Background="Transparent" BorderThickness="0">
                                <StackPanel Orientation="Horizontal">
                                    <Border Width="4" Height="16" CornerRadius="2" Margin="0,0,8,0">
                                        <Border.Background>
                                            <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                                <GradientStop Color="#EC4899" Offset="0"/>
                                                <GradientStop Color="#F472B6" Offset="1"/>
                                            </LinearGradientBrush>
                                        </Border.Background>
                                    </Border>
                                    <TextBlock Text="6차 스킬 강화" Foreground="{DynamicResource TextPrimary}" FontSize="11"/>
                                </StackPanel>
                            </Button>
                        </StackPanel>
                    </StackPanel>
                </ScrollViewer>
            </Border>

            <ScrollViewer x:Name="MainScrollViewer" Grid.Column="1" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
                <StackPanel Margin="0,0,20,0">

                    <StackPanel x:Name="GrowthReportSection" Visibility="Visible">
                        <Border CornerRadius="20" Margin="0,0,0,24" Padding="24">
                            <Border.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                    <GradientStop Color="#667EEA" Offset="0"/>
                                    <GradientStop Color="#764BA2" Offset="0.5"/>
                                    <GradientStop Color="#F093FB" Offset="1"/>
                                </LinearGradientBrush>
                            </Border.Background>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <StackPanel>
                                    <TextBlock Text="예상 레벨업 날짜" Foreground="#DDDDDD" FontSize="13"/>
                                    <TextBlock x:Name="EstimatedLevelUpText" Text="-"
                                               Foreground="White" FontSize="32" FontWeight="Bold" Margin="0,6,0,0"/>
                                </StackPanel>
                                <StackPanel Grid.Column="1">
                                    <TextBlock Text="일간 평균 경험치 상승 (최근 30일)" Foreground="#DDDDDD" FontSize="13"/>
                                    <TextBlock x:Name="WeeklyExpGrowthText" Text="-"
                                               Foreground="White" FontSize="32" FontWeight="Bold" Margin="0,6,0,0"/>
                                </StackPanel>
                            </Grid>
                        </Border>

                        <Grid x:Name="ExpPowerSection" Margin="0,0,0,24">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>

                            <Border Grid.Column="0" Margin="0,0,12,0" CornerRadius="16" 
                                    Background="{DynamicResource CardBackground}" 
                                    BorderBrush="{DynamicResource BorderColor}" BorderThickness="1">
                                <Border.Effect>
                                    <DropShadowEffect BlurRadius="20" ShadowDepth="0" Opacity="0.08" Color="#000000"/>
                                </Border.Effect>
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>

                                    <Border Grid.Row="0" CornerRadius="16,16,0,0">
                                        <Border.Background>
                                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                                <GradientStop Color="#667EEA" Offset="0"/>
                                                <GradientStop Color="#64B5F6" Offset="0.5"/>
                                                <GradientStop Color="#4DD0E1" Offset="1"/>
                                            </LinearGradientBrush>
                                        </Border.Background>
                                        <Grid Margin="20,14">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <StackPanel Orientation="Horizontal">
                                                <Border Background="#20FFFFFF" CornerRadius="8" Padding="8" Margin="0,0,14,0">
                                                    <ui:SymbolIcon Symbol="ArrowTrendingLines24" FontSize="18" Foreground="White"/>
                                                </Border>
                                                <StackPanel VerticalAlignment="Center">
                                                    <TextBlock Text="경험치 변화 내역" Foreground="White" FontSize="16" FontWeight="Bold"/>
                                                    <TextBlock Text="레벨 및 경험치 추이" Foreground="#B0FFFFFF" FontSize="10" Margin="0,2,0,0"/>
                                                </StackPanel>
                                            </StackPanel>
                                            <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center">
                                                <ComboBox x:Name="ChartDaysCombo" SelectionChanged="ChartDaysCombo_SelectionChanged"
                                                          Background="#30FFFFFF" Foreground="White" BorderThickness="0" 
                                                          FontSize="11" Padding="8,4" Margin="0,0,8,0" MinWidth="70"
                                                          Visibility="Visible">
                                                    <ComboBox.Style>
                                                        <Style TargetType="ComboBox">
                                                            <Setter Property="Template">
                                                                <Setter.Value>
                                                                    <ControlTemplate TargetType="ComboBox">
                                                                        <Grid>
                                                                            <ToggleButton x:Name="ToggleButton" Background="#30FFFFFF" BorderThickness="0"
                                                                                          IsChecked="{Binding IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}"
                                                                                          ClickMode="Press" Focusable="False">
                                                                                <ToggleButton.Template>
                                                                                    <ControlTemplate TargetType="ToggleButton">
                                                                                        <Border Background="{TemplateBinding Background}" CornerRadius="6" Padding="10,5">
                                                                                            <Grid>
                                                                                                <Grid.ColumnDefinitions>
                                                                                                    <ColumnDefinition Width="*"/>
                                                                                                    <ColumnDefinition Width="Auto"/>
                                                                                                </Grid.ColumnDefinitions>
                                                                                                <ContentPresenter Grid.Column="0" Content="{TemplateBinding Content}" 
                                                                                                                  VerticalAlignment="Center" HorizontalAlignment="Left"/>
                                                                                                <Path Grid.Column="1" Data="M0,0 L4,4 L8,0" Stroke="White" StrokeThickness="1.5"
                                                                                                      VerticalAlignment="Center" Margin="6,0,0,0"/>
                                                                                            </Grid>
                                                                                        </Border>
                                                                                    </ControlTemplate>
                                                                                </ToggleButton.Template>
                                                                                <ContentControl Content="{TemplateBinding SelectionBoxItem}" Foreground="White" FontWeight="SemiBold"/>
                                                                            </ToggleButton>
                                                                            <Popup x:Name="Popup" Placement="Bottom" IsOpen="{TemplateBinding IsDropDownOpen}"
                                                                                   AllowsTransparency="True" Focusable="False" PopupAnimation="Slide">
                                                                                <Border Background="{DynamicResource CardBackground}" CornerRadius="8" 
                                                                                        BorderBrush="{DynamicResource BorderColor}" BorderThickness="1"
                                                                                        Margin="0,4,0,0" Padding="4">
                                                                                    <Border.Effect>
                                                                                        <DropShadowEffect BlurRadius="10" ShadowDepth="2" Opacity="0.2"/>
                                                                                    </Border.Effect>
                                                                                    <StackPanel IsItemsHost="True"/>
                                                                                </Border>
                                                                            </Popup>
                                                                        </Grid>
                                                                    </ControlTemplate>
                                                                </Setter.Value>
                                                            </Setter>
                                                        </Style>
                                                    </ComboBox.Style>
                                                    <ComboBoxItem Content="7일" Tag="7"/>
                                                    <ComboBoxItem Content="30일" Tag="30" IsSelected="True"/>
                                                    <ComboBoxItem Content="90일" Tag="90"/>
                                                    <ComboBoxItem Content="전체" Tag="0"/>
                                                </ComboBox>
                                                
                                                <Border x:Name="ExpDayBorder" Background="#30FFFFFF" CornerRadius="6" Margin="0,0,4,0" Cursor="Hand">
                                                    <Button x:Name="ExpDayBtn" Content="1일" Tag="day" Click="ExpRangeButton_Click" 
                                                            Background="Transparent" BorderThickness="0" Foreground="White" 
                                                            FontSize="11" FontWeight="SemiBold" Padding="10,5"/>
                                                </Border>
                                                <Border Background="#20FFFFFF" CornerRadius="6" Margin="0,0,4,0" Cursor="Hand">
                                                    <Button x:Name="ExpWeekBtn" Content="1주" Tag="week" Click="ExpRangeButton_Click"
                                                            Background="Transparent" BorderThickness="0" Foreground="White" 
                                                            FontSize="11" FontWeight="SemiBold" Padding="10,5"/>
                                                </Border>
                                                <Border Background="#20FFFFFF" CornerRadius="6" Cursor="Hand">
                                                    <Button x:Name="ExpMonthBtn" Content="1달" Tag="month" Click="ExpRangeButton_Click"
                                                            Background="Transparent" BorderThickness="0" Foreground="White" 
                                                            FontSize="11" FontWeight="SemiBold" Padding="10,5"/>
                                                </Border>
                                            </StackPanel>
                                        </Grid>
                                    </Border>

                                    <Border Grid.Row="1" Background="{DynamicResource CardBackgroundAlt}" CornerRadius="0,0,16,16" Padding="12">
                                        <ScrollViewer HorizontalScrollBarVisibility="Visible" VerticalScrollBarVisibility="Disabled"
                                                      PreviewMouseWheel="InnerScroll_PreviewMouseWheel" Height="300">
                                            <ItemsControl x:Name="ExpGrowthList">
                                                <ItemsControl.ItemsPanel>
                                                    <ItemsPanelTemplate>
                                                        <StackPanel Orientation="Horizontal" VerticalAlignment="Bottom" Margin="6,0,6,0"/>
                                                    </ItemsPanelTemplate>
                                                </ItemsControl.ItemsPanel>
                                                <ItemsControl.ItemTemplate>
                                                    <DataTemplate>
                                                        <Grid Margin="4,0" Width="60" VerticalAlignment="Bottom">
                                                            <Grid.RowDefinitions>
                                                                <RowDefinition Height="*" />
                                                                <RowDefinition Height="Auto" />
                                                                <RowDefinition Height="Auto" />
                                                            </Grid.RowDefinitions>
                                                            <Border Grid.Row="0" VerticalAlignment="Bottom"
                                                                    Height="{Binding GraphRate, Converter={StaticResource RateToWidthConverter}, ConverterParameter=220}"
                                                                    MinHeight="3" CornerRadius="5" Background="{StaticResource ExpGradient}">
                                                                <Border.Effect>
                                                                    <DropShadowEffect BlurRadius="8" ShadowDepth="0" Opacity="0.3" Color="#667EEA"/>
                                                                </Border.Effect>
                                                            </Border>
                                                            <TextBlock Grid.Row="1" Text="{Binding Date, StringFormat=MM/dd}"
                                                                       Foreground="{DynamicResource ChartTextSecondary}" FontSize="9"
                                                                       HorizontalAlignment="Center" Margin="0,8,0,4"/>
                                                            <StackPanel Grid.Row="2" HorizontalAlignment="Center" Margin="0,0,0,4">
                                                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,0,0,2">
                                                                    <TextBlock Text="{Binding Level, StringFormat=Lv.{0}}"
                                                                               Foreground="{DynamicResource ChartTextPrimary}" FontSize="10" FontWeight="Bold"/>
                                                                    <TextBlock Text=" ⬆" Foreground="{DynamicResource AccentGreen}" FontSize="9" FontWeight="Bold"
                                                                               Visibility="{Binding LeveledUp, Converter={StaticResource BoolToVisibility}}"/>
                                                                </StackPanel>
                                                                <TextBlock Text="{Binding ExperienceRate, StringFormat={}{0:F1}%}"
                                                                           Foreground="{DynamicResource ChartTextPrimary}" FontSize="10" FontWeight="SemiBold"
                                                                           HorizontalAlignment="Center"/>
                                                                <TextBlock Text="{Binding DailyExpGainFormatted}"
                                                                           Foreground="{DynamicResource AccentGreen}" FontSize="8" FontWeight="SemiBold"
                                                                           HorizontalAlignment="Center" Opacity="0.9"/>
                                                            </StackPanel>
                                                        </Grid>
                                                    </DataTemplate>
                                                </ItemsControl.ItemTemplate>
                                            </ItemsControl>
                                        </ScrollViewer>
                                    </Border>
                                </Grid>
                            </Border>

                            <Border Grid.Column="1" Margin="12,0,0,0" CornerRadius="16" 
                                    Background="{DynamicResource CardBackground}" 
                                    BorderBrush="{DynamicResource BorderColor}" BorderThickness="1">
                                <Border.Effect>
                                    <DropShadowEffect BlurRadius="20" ShadowDepth="0" Opacity="0.08" Color="#000000"/>
                                </Border.Effect>
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>

                                    <Border Grid.Row="0" CornerRadius="16,16,0,0">
                                        <Border.Background>
                                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                                <GradientStop Color="#FF6B6B" Offset="0"/>
                                                <GradientStop Color="#FFA726" Offset="0.5"/>
                                                <GradientStop Color="#FFD54F" Offset="1"/>
                                            </LinearGradientBrush>
                                        </Border.Background>
                                        <Grid Margin="20,14">
                                            <StackPanel Orientation="Horizontal">
                                                <Border Background="#20FFFFFF" CornerRadius="8" Padding="8" Margin="0,0,14,0">
                                                    <ui:SymbolIcon Symbol="Flash24" FontSize="18" Foreground="White"/>
                                                </Border>
                                                <StackPanel VerticalAlignment="Center">
                                                    <TextBlock Text="전투력 변화 내역" Foreground="White" FontSize="16" FontWeight="Bold"/>
                                                    <StackPanel Orientation="Horizontal">
                                                        <TextBlock Text="최고 기록 : " Foreground="#B0FFFFFF" FontSize="10" Margin="0,2,0,0"/>
                                                        <TextBlock x:Name="MaxCombatPowerText" Text="-" Foreground="#FFD700" FontSize="10" FontWeight="Bold" Margin="0,2,0,0"/>
                                                    </StackPanel>
                                                </StackPanel>
                                            </StackPanel>
                                        </Grid>
                                    </Border>

                                    <Border Grid.Row="1" Background="{DynamicResource CardBackgroundAlt}" CornerRadius="0,0,16,16" Padding="12">
                                        <Grid>
                                            <ScrollViewer HorizontalScrollBarVisibility="Visible" VerticalScrollBarVisibility="Disabled"
                                                          PreviewMouseWheel="InnerScroll_PreviewMouseWheel" Height="300">
                                                <ItemsControl x:Name="CombatPowerList">
                                                    <ItemsControl.ItemsPanel>
                                                        <ItemsPanelTemplate>
                                                            <StackPanel Orientation="Horizontal" VerticalAlignment="Bottom" Margin="6,0,6,0"/>
                                                        </ItemsPanelTemplate>
                                                    </ItemsControl.ItemsPanel>
                                                    <ItemsControl.ItemTemplate>
                                                        <DataTemplate>
                                                            <Grid Margin="4,0" Width="60" VerticalAlignment="Bottom">
                                                                <Grid.RowDefinitions>
                                                                    <RowDefinition Height="*" />
                                                                    <RowDefinition Height="Auto"/>
                                                                    <RowDefinition Height="Auto"/>
                                                                </Grid.RowDefinitions>
                                                                <!-- 그래프 바 -->
                                                                <Border Grid.Row="0" VerticalAlignment="Bottom"
                                                                        Height="{Binding GraphRate, Converter={StaticResource RateToWidthConverter}, ConverterParameter=220}"
                                                                        MinHeight="3" CornerRadius="5" Background="{StaticResource PowerGradient}">
                                                                    <Border.Effect>
                                                                        <DropShadowEffect BlurRadius="8" ShadowDepth="0" Opacity="0.3" Color="#FF6B6B"/>
                                                                    </Border.Effect>
                                                                </Border>
                                                                <!-- 날짜 -->
                                                                <TextBlock Grid.Row="1" Text="{Binding Date, StringFormat=MM/dd}"
                                                                           Foreground="{DynamicResource ChartTextSecondary}" FontSize="10"
                                                                           HorizontalAlignment="Center" Margin="0,8,0,2"/>
                                                                <!-- 전투력 (한국어 단위) -->
                                                                <TextBlock Grid.Row="2" Text="{Binding NewPowerFormatted}"
                                                                           Foreground="{DynamicResource AccentOrange}" FontSize="9" FontWeight="SemiBold"
                                                                           HorizontalAlignment="Center" TextWrapping="Wrap" TextAlignment="Center"/>
                                                            </Grid>
                                                        </DataTemplate>
                                                    </ItemsControl.ItemTemplate>
                                                </ItemsControl>
                                            </ScrollViewer>
                                            <TextBlock x:Name="NoCombatPowerDataText" Text="전투력 변화 기록이 없습니다." 
                                                       Foreground="{DynamicResource TextMuted}" FontSize="13" 
                                                       HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="Collapsed"/>
                                        </Grid>
                                    </Border>
                                </Grid>
                            </Border>
                        </Grid>
                    </StackPanel>

                    <!-- HEXA Core Status (New Row Ported) -->
                     <Border x:Name="HexaCoreSection" Margin="0,20,0,0" CornerRadius="12" Padding="20"
                             Background="{DynamicResource SurfaceContainer}" BorderBrush="{DynamicResource Outline}" BorderThickness="1">
                         <Border.Effect>
                             <DropShadowEffect BlurRadius="10" ShadowDepth="0" Opacity="0.08" Color="#000000"/>
                         </Border.Effect>
                         <Grid>
                             <Grid.RowDefinitions>
                                 <RowDefinition Height="Auto"/>
                                 <RowDefinition Height="*"/>
                             </Grid.RowDefinitions>
                             <Grid.ColumnDefinitions>
                                 <ColumnDefinition Width="7*"/>
                                 <ColumnDefinition Width="3*"/>
                             </Grid.ColumnDefinitions>
                             
                             <!-- Header (Spans both columns) -->
                             <Border Grid.Row="0" Grid.ColumnSpan="2" CornerRadius="12,12,0,0" Margin="-21,-21,-21,20">
                                 <Border.Background>
                                     <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                         <GradientStop Color="#A78BFA" Offset="0"/>
                                         <GradientStop Color="#C084FC" Offset="0.5"/>
                                         <GradientStop Color="#E879F9" Offset="1"/>
                                     </LinearGradientBrush>
                                 </Border.Background>
                                 <Grid Margin="20,16">
                                     <StackPanel Orientation="Horizontal">
                                         <Border Background="#20FFFFFF" CornerRadius="8" Padding="8" Margin="0,0,14,0">
                                             <Image Source="/Data/hexa.png" Width="20" Height="20"/>
                                         </Border>
                                         <StackPanel VerticalAlignment="Center">
                                             <TextBlock Text="HEXA CORE" Foreground="White" FontSize="17" FontWeight="Bold"/>
                                             <TextBlock Text="6차 스킬 코어 정보" Foreground="#C0FFFFFF" FontSize="11" Margin="0,2,0,0"/>
                                         </StackPanel>
                                     </StackPanel>
                                     
                                     <!-- 확대/축소 토글 버튼 -->
                                     <ToggleButton HorizontalAlignment="Right" VerticalAlignment="Center"
                                                   IsChecked="{Binding RelativeSource={RelativeSource AncestorType=Window}, Path=IsHexaExpanded, Mode=TwoWay}"
                                                   Cursor="Hand" Background="Transparent" BorderThickness="0" Padding="8">
                                         <ToggleButton.Style>
                                             <Style TargetType="ToggleButton">
                                                 <Setter Property="Template">
                                                     <Setter.Value>
                                                         <ControlTemplate TargetType="ToggleButton">
                                                             <Border Background="{TemplateBinding Background}" CornerRadius="8" Padding="{TemplateBinding Padding}">
                                                                 <StackPanel Orientation="Horizontal">
                                                                     <TextBlock x:Name="ToggleText" Text="확대" Foreground="#E0E0E0" FontSize="12" VerticalAlignment="Center" Margin="0,0,6,0"/>
                                                                     <ui:SymbolIcon x:Name="ToggleIcon" Symbol="ArrowMaximize16" FontSize="16" Foreground="White" />
                                                                 </StackPanel>
                                                             </Border>
                                                             <ControlTemplate.Triggers>
                                                                 <Trigger Property="IsChecked" Value="True">
                                                                     <Setter TargetName="ToggleText" Property="Text" Value="축소"/>
                                                                     <Setter TargetName="ToggleIcon" Property="Symbol" Value="ArrowMinimize16"/>
                                                                 </Trigger>
                                                                 <Trigger Property="IsMouseOver" Value="True">
                                                                     <Setter Property="Background" Value="#20FFFFFF"/>
                                                                 </Trigger>
                                                             </ControlTemplate.Triggers>
                                                         </ControlTemplate>
                                                     </Setter.Value>
                                                 </Setter>
                                             </Style>
                                         </ToggleButton.Style>
                                     </ToggleButton>
                                 </Grid>
                             </Border>
                             
                             <!-- HEXA CORE -->
                             <StackPanel Grid.Row="1" Grid.Column="0">
                                 <ItemsControl x:Name="HexaCoreGroups">
                                     <ItemsControl.ItemsPanel>
                                         <ItemsPanelTemplate>
                                             <UniformGrid Columns="2" VerticalAlignment="Top"/>
                                         </ItemsPanelTemplate>
                                     </ItemsControl.ItemsPanel>
                                     <ItemsControl.ItemTemplate>
                                         <DataTemplate>
                                             <Grid Margin="6">
                                                 <Grid.Style>
                                                     <Style TargetType="Grid">
                                                         <Setter Property="MinHeight" Value="54"/> <!-- 기본 축소 높이 -->
                                                         <Style.Triggers>
                                                             <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=Window}, Path=IsHexaExpanded}" Value="True">
                                                                 <Setter Property="MinHeight" Value="100"/>
                                                             </DataTrigger>
                                                         </Style.Triggers>
                                                     </Style>
                                                 </Grid.Style>
                                                 <Border CornerRadius="12" Background="{DynamicResource CardBackgroundAlt}" 
                                                         BorderBrush="{DynamicResource BorderColor}" BorderThickness="1"
                                                         Tag="{Binding}"
                                                         Cursor="Hand"
                                                         MouseEnter="HexaSkill_MouseEnter"
                                                         MouseLeave="HexaSkill_MouseLeave"
                                                         MouseMove="HexaSkill_MouseMove">
                                                     <Grid>
                                                         <!-- 게이지 배경 -->
                                                         <Border HorizontalAlignment="Stretch" VerticalAlignment="Stretch" CornerRadius="12">
                                                             <Border.Background>
                                                                 <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                                                     <GradientStop Color="#40A78BFA" Offset="{Binding ProgressFactor}"/>
                                                                     <GradientStop Color="Transparent" Offset="{Binding ProgressFactor}"/>
                                                                 </LinearGradientBrush>
                                                             </Border.Background>
                                                         </Border>
                                                         
                                                         <Grid Margin="8">
                                                             <Grid.ColumnDefinitions>
                                                                 <ColumnDefinition Width="Auto"/>
                                                                 <ColumnDefinition Width="*"/>
                                                             </Grid.ColumnDefinitions>
                                                             
                                                             <!-- 아이콘 -->
                                                              <Grid Grid.Column="0" Width="44" Height="44" Margin="0,0,12,0" VerticalAlignment="Center">
                                                                 <Border CornerRadius="8" Background="#20000000" IsHitTestVisible="False">
                                                                     <Image Source="{Binding SkillIcon}" Stretch="Uniform" Margin="4" IsHitTestVisible="False"/>
                                                                 </Border>
                                                                 <Border Background="#CC000000" CornerRadius="4" VerticalAlignment="Bottom" HorizontalAlignment="Left" Padding="4,1" Margin="-4,0,0,-4" IsHitTestVisible="False">
                                                                     <TextBlock Text="{Binding CoreLevel, StringFormat='Lv.{0}'}" Foreground="White" FontSize="10" FontWeight="Bold" IsHitTestVisible="False"/>
                                                                 </Border>
                                                             </Grid>
                                                             
                                                             <!-- 텍스트 정보 -->
                                                             <Grid Grid.Column="1" VerticalAlignment="Center">
                                                                 <Grid.RowDefinitions>
                                                                     <RowDefinition Height="Auto"/>
                                                                     <RowDefinition Height="Auto"/>
                                                                     <RowDefinition Height="Auto"/>
                                                                 </Grid.RowDefinitions>
                                                                 
                                                                 <!-- 스킬명 & 진행도 -->
                                                                 <Grid Grid.Row="0" Margin="0,0,0,6">
                                                                     <Grid.ColumnDefinitions>
                                                                         <ColumnDefinition Width="*"/>
                                                                         <ColumnDefinition Width="Auto"/>
                                                                     </Grid.ColumnDefinitions>
                                                                     <TextBlock Text="{Binding SkillName}" FontWeight="Bold" FontSize="14" Foreground="{DynamicResource TextPrimary}"/>
                                                                     <TextBlock Grid.Column="1" Text="{Binding ProgressText}" Foreground="#A78BFA" FontWeight="Bold" FontSize="14"/>
                                                                 </Grid>
                                                                 
                                                                 <!-- 상세 정보 패널 (애니메이션 적용) -->
                                                                 <StackPanel x:Name="DetailsPanel" Grid.Row="1" Grid.RowSpan="2" ClipToBounds="True">
                                                                     <StackPanel.Style>
                                                                         <Style TargetType="StackPanel">
                                                                             <Setter Property="MaxHeight" Value="0"/>
                                                                             <Setter Property="Opacity" Value="0"/>
                                                                             <Style.Triggers>
                                                                                 <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=Window}, Path=IsHexaExpanded}" Value="True">
                                                                                     <DataTrigger.EnterActions>
                                                                                         <BeginStoryboard>
                                                                                             <Storyboard>
                                                                                                 <DoubleAnimation Storyboard.TargetProperty="MaxHeight" To="300" Duration="0:0:0.3" DecelerationRatio="0.5"/>
                                                                                                 <DoubleAnimation Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.2"/>
                                                                                             </Storyboard>
                                                                                         </BeginStoryboard>
                                                                                     </DataTrigger.EnterActions>
                                                                                     <DataTrigger.ExitActions>
                                                                                         <BeginStoryboard>
                                                                                             <Storyboard>
                                                                                                 <DoubleAnimation Storyboard.TargetProperty="MaxHeight" To="0" Duration="0:0:0.3" AccelerationRatio="0.5"/>
                                                                                                 <DoubleAnimation Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.2"/>
                                                                                             </Storyboard>
                                                                                         </BeginStoryboard>
                                                                                     </DataTrigger.ExitActions>
                                                                                 </DataTrigger>
                                                                             </Style.Triggers>
                                                                         </Style>
                                                                     </StackPanel.Style>
                                                                 
                                                                     <!-- 다음 레벨 비용 -->
                                                                     <Grid Grid.Row="1" Margin="0,0,0,2">
                                                                         <Grid.ColumnDefinitions>
                                                                             <ColumnDefinition Width="65"/>
                                                                             <ColumnDefinition Width="Auto"/>
                                                                             <ColumnDefinition Width="Auto"/>
                                                                         </Grid.ColumnDefinitions>
                                                                         <TextBlock Text="다음 레벨" Foreground="{DynamicResource TextSecondary}" FontSize="11"/>
                                                                         <StackPanel Grid.Column="1" Orientation="Horizontal" Width="55">
                                                                             <Image Source="/Data/sol-erda.png" Width="14" Height="14" Margin="0,0,4,0"/>
                                                                             <TextBlock Text="{Binding NextSolErdaText}" FontSize="11" Foreground="{DynamicResource TextPrimary}"/>
                                                                         </StackPanel>
                                                                         <StackPanel Grid.Column="2" Orientation="Horizontal">
                                                                             <Image Source="/Data/sol-erda-fragment.png" Width="14" Height="14" Margin="0,0,4,0"/>
                                                                             <TextBlock Text="{Binding NextFragmentText}" FontSize="11" Foreground="{DynamicResource TextPrimary}"/>
                                                                         </StackPanel>
                                                                     </Grid>
                                                                 
                                                                     <!-- 졸업까지 비용 -->
                                                                     <Grid Grid.Row="2">
                                                                         <Grid.ColumnDefinitions>
                                                                             <ColumnDefinition Width="65"/>
                                                                             <ColumnDefinition Width="Auto"/>
                                                                             <ColumnDefinition Width="Auto"/>
                                                                         </Grid.ColumnDefinitions>
                                                                         <TextBlock Text="졸업까지" Foreground="{DynamicResource TextSecondary}" FontSize="11"/>
                                                                         <StackPanel Grid.Column="1" Orientation="Horizontal" Width="55">
                                                                             <Image Source="/Data/sol-erda.png" Width="14" Height="14" Margin="0,0,4,0"/>
                                                                             <TextBlock Text="{Binding RemainingSolErdaText}" FontSize="11" Foreground="{DynamicResource TextPrimary}"/>
                                                                         </StackPanel>
                                                                         <StackPanel Grid.Column="2" Orientation="Horizontal">
                                                                             <Image Source="/Data/sol-erda-fragment.png" Width="14" Height="14" Margin="0,0,4,0"/>
                                                                             <TextBlock Text="{Binding RemainingFragmentText}" FontSize="11" Foreground="{DynamicResource TextPrimary}"/>
                                                                         </StackPanel>
                                                                     </Grid>
                                                                 </StackPanel>
                                                             </Grid>
                                                         </Grid>
                                                     </Grid>
                                                 </Border>
                                             </Grid>
                                         </DataTemplate>
                                     </ItemsControl.ItemTemplate>
                                 </ItemsControl>
                                 
                                 <TextBlock x:Name="NoHexaText" Text="HEXA 코어 정보 없음" 
                                            Foreground="{DynamicResource OnSurfaceVariant}" FontSize="15" Margin="0,16,0,0" Visibility="Collapsed"/>
                             </StackPanel>
                             
                             <!-- HEXA STAT (Col 1) -->
                             <ItemsControl x:Name="HexaStatCoreList" Grid.Row="1" Grid.Column="1" Margin="20,0,0,0">
                                 <ItemsControl.ItemsPanel>
                                     <ItemsPanelTemplate>
                                         <StackPanel Orientation="Vertical"/>
                                     </ItemsPanelTemplate>
                                 </ItemsControl.ItemsPanel>
                                 <ItemsControl.ItemTemplate>
                                     <DataTemplate>
                                         <Border CornerRadius="12" Margin="0,0,0,8" BorderThickness="1" BorderBrush="{DynamicResource BorderColor}"
                                                 Background="{DynamicResource CardBackgroundAlt}">
                                             <Grid Margin="10">
                                                 <Grid.ColumnDefinitions>
                                                     <ColumnDefinition Width="Auto"/> 
                                                     <ColumnDefinition Width="*"/>    
                                                     <ColumnDefinition Width="Auto"/> 
                                                 </Grid.ColumnDefinitions>
                                                 
                                                 <!-- 슬롯 번호 -->
                                                 <Border Grid.Column="0" Width="32" Height="32" CornerRadius="8" Margin="0,0,16,0" VerticalAlignment="Center">
                                                     <Border.Background>
                                                         <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                                             <GradientStop Color="#A78BFA" Offset="0"/>
                                                             <GradientStop Color="#7C3AED" Offset="1"/>
                                                         </LinearGradientBrush>
                                                     </Border.Background>
                                                     <TextBlock Text="{Binding SlotIndex}" Foreground="White" FontWeight="Bold" FontSize="16" 
                                                                HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                 </Border>
                                                 
                                                 <!-- 스탯 정보 -->
                                                 <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                                     <TextBlock Text="{Binding MainStat}" Foreground="#A78BFA" FontWeight="Bold" FontSize="15" Margin="0,0,0,4"/>
                                                     
                                                     <!-- 상세 스탯 (애니메이션 적용) -->
                                                     <StackPanel x:Name="StatDetails" ClipToBounds="True">
                                                         <StackPanel.Style>
                                                             <Style TargetType="StackPanel">
                                                                 <Setter Property="MaxHeight" Value="0"/>
                                                                 <Setter Property="Opacity" Value="0"/>
                                                                 <Style.Triggers>
                                                                     <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=Window}, Path=IsHexaExpanded}" Value="True">
                                                                         <DataTrigger.EnterActions>
                                                                             <BeginStoryboard>
                                                                                 <Storyboard>
                                                                                     <DoubleAnimation Storyboard.TargetProperty="MaxHeight" To="50" Duration="0:0:0.3" DecelerationRatio="0.5"/>
                                                                                     <DoubleAnimation Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.2"/>
                                                                                 </Storyboard>
                                                                             </BeginStoryboard>
                                                                         </DataTrigger.EnterActions>
                                                                         <DataTrigger.ExitActions>
                                                                             <BeginStoryboard>
                                                                                 <Storyboard>
                                                                                     <DoubleAnimation Storyboard.TargetProperty="MaxHeight" To="0" Duration="0:0:0.3" AccelerationRatio="0.5"/>
                                                                                     <DoubleAnimation Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.2"/>
                                                                                 </Storyboard>
                                                                             </BeginStoryboard>
                                                                         </DataTrigger.ExitActions>
                                                                     </DataTrigger>
                                                                 </Style.Triggers>
                                                             </Style>
                                                         </StackPanel.Style>
                                                         
                                                         <StackPanel Orientation="Horizontal" Margin="0,0,0,2">
                                                             <TextBlock Text="{Binding SubStat1}" Foreground="{DynamicResource TextSecondary}" FontSize="12" Margin="0,0,4,0"/>
                                                             <TextBlock Text="Lv." Foreground="{DynamicResource TextSecondary}" FontSize="11" VerticalAlignment="Bottom" Margin="0,0,1,1"/>
                                                             <TextBlock Text="{Binding SubLevel1}" Foreground="{DynamicResource TextPrimary}" FontWeight="SemiBold" FontSize="12"/>
                                                         </StackPanel>
                                                         
                                                         <StackPanel Orientation="Horizontal">
                                                             <TextBlock Text="{Binding SubStat2}" Foreground="{DynamicResource TextSecondary}" FontSize="12" Margin="0,0,4,0"/>
                                                             <TextBlock Text="Lv." Foreground="{DynamicResource TextSecondary}" FontSize="11" VerticalAlignment="Bottom" Margin="0,0,1,1"/>
                                                             <TextBlock Text="{Binding SubLevel2}" Foreground="{DynamicResource TextPrimary}" FontWeight="SemiBold" FontSize="12"/>
                                                         </StackPanel>
                                                     </StackPanel>
                                                 </StackPanel>
                                                 <StackPanel Grid.Column="2" VerticalAlignment="Center" HorizontalAlignment="Right" Margin="16,0,0,0">
                                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Bottom" Margin="0,0,0,4">
                                                        <TextBlock Text="Lv." Foreground="{DynamicResource TextSecondary}" FontSize="13" VerticalAlignment="Bottom" Margin="0,0,3,3"/>
                                                        <TextBlock Text="{Binding MainLevel}" FontWeight="Bold" FontSize="20" Foreground="{DynamicResource TextPrimary}"/>
                                                    </StackPanel>
                                                </StackPanel>
                                            </Grid>
                                         </Border>
                                     </DataTemplate>
                                 </ItemsControl.ItemTemplate>
                             </ItemsControl>
                             <TextBlock x:Name="NoHexaStatText" Text="HEXA 스탯 정보 없음" 
                                        Foreground="{DynamicResource OnSurfaceVariant}" FontSize="15" Margin="20,16,0,0" Visibility="Collapsed" Grid.Row="1" Grid.Column="1"/>
                         </Grid>
                     </Border>
                        <Grid x:Name="EquipmentSection" Margin="0,0,0,16" MinHeight="650">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>

                            <Border Grid.Column="0" Height="700" Margin="0,0,12,0" CornerRadius="16" 
                                    Background="{DynamicResource CardBackground}" 
                                    BorderBrush="{DynamicResource BorderColor}" BorderThickness="1">
                                <Border.Effect>
                                    <DropShadowEffect BlurRadius="20" ShadowDepth="0" Opacity="0.08" Color="#000000"/>
                                </Border.Effect>
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>  <RowDefinition Height="Auto"/>  <RowDefinition Height="*"/>     </Grid.RowDefinitions>

                                    <Border Grid.Row="0" CornerRadius="16,16,0,0">
                                        <Border.Background>
                                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                                <GradientStop Color="#5AC8FA" Offset="0"/>
                                                <GradientStop Color="#38BDF8" Offset="0.4"/>
                                                <GradientStop Color="#22D3EE" Offset="1"/>
                                            </LinearGradientBrush>
                                        </Border.Background>
                                        <Grid Margin="20,16">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <StackPanel Orientation="Horizontal">
                                                <Border Background="#20FFFFFF" CornerRadius="8" Padding="8" Margin="0,0,14,0">
                                                    <ui:SymbolIcon Symbol="Shield24" FontSize="20" Foreground="White"/>
                                                </Border>
                                                <StackPanel VerticalAlignment="Center">
                                                    <TextBlock Text="장비 변경 내역" Foreground="White" FontSize="17" FontWeight="Bold"/>
                                                    <TextBlock Text="최근 장비 강화 및 교체 기록" Foreground="#C0FFFFFF" FontSize="11" Margin="0,2,0,0"/>
                                                </StackPanel>
                                            </StackPanel>
                                            <Border Grid.Column="1" Background="#30FFFFFF" CornerRadius="6" Cursor="Hand" 
                                                    MouseLeftButtonDown="ItemFilterButton_Click">
                                                <Button x:Name="ItemFilterButton" 
                                                        Background="Transparent" BorderThickness="0" 
                                                        Padding="10,6" Cursor="Hand" Click="ItemFilterButton_Click">
                                                    <StackPanel Orientation="Horizontal">
                                                        <ui:SymbolIcon Symbol="Filter24" FontSize="14" Foreground="White" Margin="0,0,6,0"/>
                                                        <TextBlock Text="필터" Foreground="White" FontSize="12" FontWeight="SemiBold"/>
                                                    </StackPanel>
                                                </Button>
                                            </Border>
                                        </Grid>
                                    </Border>

                                    <Border x:Name="ItemFilterPanel" Grid.Row="1" 
                                            Background="{DynamicResource CardBackgroundAlt}" 
                                            BorderBrush="{DynamicResource BorderColor}" BorderThickness="0,1,0,0"
                                            Padding="16,12" Visibility="Collapsed">
                                        <StackPanel>
                                            <TextBlock Text="필터 옵션" Foreground="{DynamicResource TextPrimary}" 
                                                       FontSize="13" FontWeight="Bold" Margin="0,0,0,12"/>
                                            
                                            <CheckBox x:Name="FilterPresetItems" Content="프리셋 아이템 표시" 
                                                      Foreground="{DynamicResource TextPrimary}" FontSize="12"
                                                      IsChecked="False" Checked="ItemFilter_Changed" Unchecked="ItemFilter_Changed"
                                                      Margin="0,0,0,8"/>
                                            
                                            <CheckBox x:Name="FilterSpiritPendant" Content="정령의 펜던트 표시" 
                                                      Foreground="{DynamicResource TextPrimary}" FontSize="12"
                                                      IsChecked="False" Checked="ItemFilter_Changed" Unchecked="ItemFilter_Changed"
                                                      Margin="0,0,0,8"/>
                                            
                                            <CheckBox x:Name="FilterMedalTitle" Content="훈장 / 칭호 표시" 
                                                      Foreground="{DynamicResource TextPrimary}" FontSize="12"
                                                      IsChecked="True" Checked="ItemFilter_Changed" Unchecked="ItemFilter_Changed"
                                                      Margin="0,0,0,8"/>
                                            
                                            <TextBlock Text="변경 타입" Foreground="{DynamicResource TextSecondary}" 
                                                       FontSize="11" FontWeight="SemiBold" Margin="0,4,0,6"/>
                                            <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                                <CheckBox x:Name="FilterTypeEquip" Content="장착" Tag="장착"
                                                          Foreground="{DynamicResource TextPrimary}" FontSize="11"
                                                          IsChecked="True" Checked="ItemFilter_Changed" Unchecked="ItemFilter_Changed"
                                                          Margin="0,0,12,0"/>
                                                <CheckBox x:Name="FilterTypeReplace" Content="교체" Tag="교체"
                                                          Foreground="{DynamicResource TextPrimary}" FontSize="11"
                                                          IsChecked="True" Checked="ItemFilter_Changed" Unchecked="ItemFilter_Changed"
                                                          Margin="0,0,12,0"/>
                                                <CheckBox x:Name="FilterTypeOption" Content="옵션 변경" Tag="옵션 변경"
                                                          Foreground="{DynamicResource TextPrimary}" FontSize="11"
                                                          IsChecked="True" Checked="ItemFilter_Changed" Unchecked="ItemFilter_Changed"/>
                                            </StackPanel>
                                            
                                            <TextBlock Text="날짜 범위" Foreground="{DynamicResource TextSecondary}" 
                                                       FontSize="11" FontWeight="SemiBold" Margin="0,4,0,6"/>
                                            <ComboBox x:Name="ItemDateRangeCombo" FontSize="11" 
                                                      SelectionChanged="ItemDateRangeCombo_SelectionChanged" Margin="0,0,0,8">
                                                <ComboBoxItem Content="전체" Tag="0" IsSelected="True"/>
                                                <ComboBoxItem Content="최근 7일" Tag="7"/>
                                                <ComboBoxItem Content="최근 30일" Tag="30"/>
                                                <ComboBoxItem Content="최근 90일" Tag="90"/>
                                            </ComboBox>
                                            
                                            <Border Background="{DynamicResource BorderColor}" CornerRadius="4" 
                                                    HorizontalAlignment="Left">
                                                <Button Content="필터 초기화" FontSize="11" Padding="8,4" 
                                                        Background="Transparent" 
                                                        Foreground="{DynamicResource TextPrimary}"
                                                        BorderThickness="0"
                                                        Click="ItemFilterReset_Click"/>
                                            </Border>
                                        </StackPanel>
                                    </Border>

                                    <ScrollViewer x:Name="ItemListScrollViewer" Grid.Row="2" VerticalScrollBarVisibility="Auto"
                                                  PreviewMouseWheel="InnerScroll_PreviewMouseWheel">
                                        <Grid Margin="12,12,12,12">
                                            <ListBox x:Name="ItemChangeList"
                                                     BorderThickness="0"
                                                     Background="Transparent"
                                                     ScrollViewer.VerticalScrollBarVisibility="Disabled">
                                                <ListBox.ItemContainerStyle>
                                                    <Style TargetType="ListBoxItem">
                                                        <Setter Property="Padding" Value="0"/>
                                                        <Setter Property="Margin" Value="0"/>
                                                        <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                                                        <Setter Property="Template">
                                                            <Setter.Value>
                                                                <ControlTemplate TargetType="ListBoxItem">
                                                                    <Border x:Name="ItemBorder" Background="Transparent" CornerRadius="12">
                                                                        <ContentPresenter/>
                                                                    </Border>
                                                                    <ControlTemplate.Triggers>
                                                                        <Trigger Property="IsSelected" Value="True">
                                                                            <Setter TargetName="ItemBorder" Property="Background" Value="#255AC8FA"/>
                                                                        </Trigger>
                                                                        <Trigger Property="IsMouseOver" Value="True">
                                                                            <Setter TargetName="ItemBorder" Property="Background" Value="#125AC8FA"/>
                                                                        </Trigger>
                                                                    </ControlTemplate.Triggers>
                                                                </ControlTemplate>
                                                            </Setter.Value>
                                                        </Setter>
                                                    </Style>
                                                </ListBox.ItemContainerStyle>
                                                <ListBox.ItemTemplate>
                                                    <DataTemplate>
                                                        <Border Background="{DynamicResource ItemCardBackground}" 
                                                                CornerRadius="14" Padding="14,10" Margin="2,2,2,8"
                                                                BorderBrush="{DynamicResource ItemCardBorder}" BorderThickness="1"
                                                                Cursor="Hand"
                                                                MouseEnter="ItemSlot_MouseEnter"
                                                                MouseLeave="ItemSlot_MouseLeave"
                                                                MouseMove="ItemSlot_MouseMove">
                                                            <Border.Effect>
                                                                <DropShadowEffect BlurRadius="8" ShadowDepth="0" Opacity="0.04" Color="#000000"/>
                                                            </Border.Effect>
                                                            <Grid>
                                                                <Grid.ColumnDefinitions>
                                                                    <ColumnDefinition Width="Auto"/>
                                                                    <ColumnDefinition Width="*"/>
                                                                    <ColumnDefinition Width="Auto"/>
                                                                </Grid.ColumnDefinitions>

                                                                <!-- 아이템 아이콘 + NEW 태그 -->
                                                                <Grid Width="66" Height="66" Margin="0,0,10,0">
                                                                    <Border Width="58" Height="58" CornerRadius="12" BorderThickness="2"
                                                                            HorizontalAlignment="Center" VerticalAlignment="Center">
                                                                        <Border.BorderBrush>
                                                                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                                                                <GradientStop Color="#5AC8FA" Offset="0"/>
                                                                                <GradientStop Color="#A78BFA" Offset="1"/>
                                                                            </LinearGradientBrush>
                                                                        </Border.BorderBrush>
                                                                        <Border.Background>
                                                                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                                                                <GradientStop Color="#155AC8FA" Offset="0"/>
                                                                                <GradientStop Color="#10A78BFA" Offset="1"/>
                                                                            </LinearGradientBrush>
                                                                        </Border.Background>
                                                                        <Image Width="40" Height="40" Stretch="Uniform"
                                                                               Source="{Binding ItemInfoJson, Converter={StaticResource JsonToItemInfoConverter}, ConverterParameter=Icon}"
                                                                               HorizontalAlignment="Center" VerticalAlignment="Center"
                                                                               RenderOptions.BitmapScalingMode="NearestNeighbor"/>
                                                                    </Border>
                                                                    <!-- NEW 태그 (아이콘 오른쪽 상단) -->
                                                                    <Border Visibility="{Binding IsNewItem, Converter={StaticResource BoolToVisibility}}"
                                                                            HorizontalAlignment="Right" VerticalAlignment="Top" 
                                                                            CornerRadius="6" Padding="5,2">
                                                                        <Border.Effect>
                                                                            <DropShadowEffect BlurRadius="8" ShadowDepth="1" Opacity="0.3" Color="#000000"/>
                                                                        </Border.Effect>
                                                                        <Border.Background>
                                                                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                                                                <GradientStop Color="#FF6B6B" Offset="0"/>
                                                                                <GradientStop Color="#FF8E53" Offset="1"/>
                                                                            </LinearGradientBrush>
                                                                        </Border.Background>
                                                                        <TextBlock Text="NEW" Foreground="White" FontSize="8" FontWeight="ExtraBold"/>
                                                                    </Border>
                                                                </Grid>

                                                                <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,6">
                                                                        <Border CornerRadius="6" Padding="8,3" Margin="0,0,8,0">
                                                                            <Border.Background>
                                                                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                                                                    <GradientStop Color="#A78BFA" Offset="0"/>
                                                                                    <GradientStop Color="#8B5CF6" Offset="1"/>
                                                                                </LinearGradientBrush>
                                                                            </Border.Background>
                                                                            <TextBlock Text="{Binding ItemSlot}" Foreground="White" FontSize="10" FontWeight="Bold"/>
                                                                        </Border>
                                                                        <Border Background="#10000000" CornerRadius="4" Padding="6,2" Margin="0,0,8,0">
                                                                            <TextBlock Text="{Binding Date, StringFormat=yyyy.MM.dd}" 
                                                                                       Foreground="{DynamicResource TextMuted}" FontSize="10"/>
                                                                        </Border>
                                                                        <Border Visibility="{Binding IsNewItem, Converter={StaticResource BoolToVisibility}}"
                                                                                CornerRadius="4" Padding="6,2">
                                                                            <Border.Background>
                                                                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                                                                    <GradientStop Color="#2010B981" Offset="0"/>
                                                                                    <GradientStop Color="#2034D399" Offset="1"/>
                                                                                </LinearGradientBrush>
                                                                            </Border.Background>
                                                                            <TextBlock Text="✨ 신규 장착" Foreground="{DynamicResource AccentGreen}" FontSize="9" FontWeight="SemiBold"/>
                                                                        </Border>
                                                                    </StackPanel>

                                                                    <TextBlock Text="{Binding NewItemName}" 
                                                                               Foreground="{DynamicResource TextPrimary}" FontSize="15" FontWeight="SemiBold"
                                                                               TextTrimming="CharacterEllipsis" Margin="0,0,0,8"/>

                                                                    <ItemsControl ItemsSource="{Binding OptionChanges}" Margin="0,0,0,4">
                                                                        <ItemsControl.ItemTemplate>
                                                                            <DataTemplate>
                                                                                <Border Margin="0,0,0,4" Padding="8,5" CornerRadius="6"
                                                                                        Background="#10000000"
                                                                                        Visibility="{Binding IsNewItem, Converter={StaticResource BoolToVisibilityInverse}}">
                                                                                    <StackPanel Orientation="Horizontal">
                                                                                        <TextBlock Text="{Binding Category}" Foreground="{DynamicResource TextMuted}" 
                                                                                                   FontSize="11" FontWeight="Medium" Margin="0,0,8,0" MinWidth="70"/>
                                                                                        <TextBlock Text="{Binding DisplayText}" Foreground="{DynamicResource AccentCyan}" 
                                                                                                   FontSize="11" FontWeight="SemiBold" TextWrapping="Wrap" MaxWidth="180"/>
                                                                                    </StackPanel>
                                                                                </Border>
                                                                            </DataTemplate>
                                                                        </ItemsControl.ItemTemplate>
                                                                    </ItemsControl>

                                                                    <Border CornerRadius="8" Padding="10,6" HorizontalAlignment="Left"
                                                                            Visibility="{Binding OptionChanges.Count, Converter={StaticResource CountToVisibilityInverse}}">
                                                                        <Border.Background>
                                                                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                                                                <GradientStop Color="#1834D399" Offset="0"/>
                                                                                <GradientStop Color="#1010B981" Offset="1"/>
                                                                            </LinearGradientBrush>
                                                                        </Border.Background>
                                                                        <StackPanel Orientation="Horizontal">
                                                                            <Border Background="{DynamicResource AccentGreen}" CornerRadius="10" Width="18" Height="18" Margin="0,0,8,0">
                                                                                <TextBlock Text="↑" Foreground="White" FontSize="10" FontWeight="Bold" 
                                                                                           HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                                            </Border>
                                                                            <TextBlock Text="{Binding ChangeSummary}" Foreground="{DynamicResource AccentGreen}" 
                                                                                       FontSize="12" FontWeight="Medium" TextWrapping="Wrap" MaxWidth="220"/>
                                                                        </StackPanel>
                                                                    </Border>
                                                                </StackPanel>

                                                                <Border Grid.Column="2" Background="#08000000" CornerRadius="8" Width="32" Height="32" 
                                                                        VerticalAlignment="Center" Margin="8,0,0,0">
                                                                    <ui:SymbolIcon Symbol="ChevronRight24" FontSize="14" 
                                                                                   Foreground="{DynamicResource TextMuted}" 
                                                                                   HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                                </Border>
                                                            </Grid>
                                                        </Border>
                                                    </DataTemplate>
                                                </ListBox.ItemTemplate>
                                            </ListBox>
                                            <TextBlock x:Name="NoItemChangeDataText" Text="장비 변경 기록이 없습니다." 
                                                       Foreground="{DynamicResource TextMuted}" FontSize="13" 
                                                       HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="Collapsed"/>
                                        </Grid>
                                    </ScrollViewer>
                                </Grid>
                            </Border>

                                <StackPanel Grid.Column="1" Margin="12,0,0,0">

                                    
                                    <Border x:Name="HexaSkillSection" Height="700" Margin="0,24,0,16" CornerRadius="16"
                                            Background="{DynamicResource CardBackground}" 
                                            BorderBrush="{DynamicResource BorderColor}" BorderThickness="1">
                                        <Border.Effect>
                                            <DropShadowEffect BlurRadius="20" ShadowDepth="0" Opacity="0.08" Color="#000000"/>
                                        </Border.Effect>
                                        <Grid>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="*"/>
                                            </Grid.RowDefinitions>
            
                                            <Border Grid.Row="0" CornerRadius="16,16,0,0" Padding="20,12">
                                                <Border.Background>
                                                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                                        <GradientStop Color="#EC4899" Offset="0"/>
                                                        <GradientStop Color="#F472B6" Offset="0.5"/>
                                                        <GradientStop Color="#FB7185" Offset="1"/>
                                                    </LinearGradientBrush>
                                                </Border.Background>
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="*"/>
                                                    </Grid.ColumnDefinitions>
                                                    <Border Width="44" Height="44" CornerRadius="12" Background="#20FFFFFF" Margin="0,0,14,0">
                                                        <Image Source="/Data/hexa.png" Width="28" Height="28" 
                                                               RenderOptions.BitmapScalingMode="Fant"/>
                                                    </Border>
                                                    <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                                        <TextBlock Text="6차 스킬 강화 상세 내역" Foreground="White" FontSize="17" FontWeight="Bold"/>
                                                        <TextBlock Text="코어 레벨 변경 히스토리" Foreground="#C0FFFFFF" FontSize="11" Margin="0,2,0,0"/>
                                                    </StackPanel>
                                                </Grid>
                                            </Border>
            
                                            <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto"
                                                          PreviewMouseWheel="InnerScroll_PreviewMouseWheel" Padding="12">
                                                <Grid>
                                                    <ItemsControl x:Name="HexaSkillList">
                                                        <ItemsControl.ItemsPanel>
                                                            <ItemsPanelTemplate>
                                                                <StackPanel Orientation="Vertical"/>
                                                            </ItemsPanelTemplate>
                                                        </ItemsControl.ItemsPanel>
                                                        <ItemsControl.ItemTemplate>
                                                            <DataTemplate>
                                                                <Border Margin="4" CornerRadius="12" 
                                                                        Background="{DynamicResource CardBackgroundAlt}" Padding="12">
                                                                    <StackPanel>
                                                                        <Border CornerRadius="8" Padding="10,5" Margin="0,0,0,10" HorizontalAlignment="Left">
                                                                            <Border.Background>
                                                                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                                                                    <GradientStop Color="#EC4899" Offset="0"/>
                                                                                    <GradientStop Color="#F472B6" Offset="1"/>
                                                                                </LinearGradientBrush>
                                                                            </Border.Background>
                                                                            <TextBlock Text="{Binding Date, StringFormat=yyyy/MM/dd}"
                                                                                       Foreground="White" FontSize="12" FontWeight="Bold"/>
                                                                        </Border>
                                                                        
                                                                        <ItemsControl ItemsSource="{Binding Items}">
                                                                            <ItemsControl.ItemTemplate>
                                                                                <DataTemplate>
                                                                                    <Border Background="{DynamicResource CardBackground}" 
                                                                                            CornerRadius="10" Padding="12,10" Margin="0,0,0,6"
                                                                                            BorderBrush="{DynamicResource BorderColor}" BorderThickness="1"
                                                                                            Tag="{Binding}">
                                                                                            <!-- MouseEnter="HexaSkill_MouseEnter"
                                                                                            MouseLeave="HexaSkill_MouseLeave"
                                                                                            MouseMove="HexaSkill_MouseMove" -->
                                                                                            <Grid>
                                                                                            <Grid.ColumnDefinitions>
                                                                                                <ColumnDefinition Width="Auto"/>
                                                                                                <ColumnDefinition Width="Auto"/>
                                                                                                <ColumnDefinition Width="*"/>
                                                                                                <ColumnDefinition Width="Auto"/>
                                                                                            </Grid.ColumnDefinitions>
                                                                                            
                                                                                            <Border Width="40" Height="40" CornerRadius="10">
                                                                                                <Border.Background>
                                                                                                    <SolidColorBrush Color="Transparent"/>
                                                                                                </Border.Background>
                                                                                                <Image Source="{Binding SkillIcon}" Width="26" Height="26" 
                                                                                                       HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                                                            </Border>
                                                                                            
                                                                                            <StackPanel Grid.Column="1" Margin="12,0,0,0" VerticalAlignment="Center">
                                                                                                <TextBlock Text="{Binding SkillName}" 
                                                                                                           Foreground="{DynamicResource TextPrimary}" 
                                                                                                           FontSize="15" FontWeight="SemiBold" 
                                                                                                           TextTrimming="CharacterEllipsis" MaxWidth="150"/>
                                                                                            </StackPanel>
                                                                                            
                                                                                            <Border Grid.Column="3" CornerRadius="6" Padding="8,4" VerticalAlignment="Center">
                                                                                                <Border.Background>
                                                                                                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                                                                                        <GradientStop Color="#10B981" Offset="0"/>
                                                                                                        <GradientStop Color="#34D399" Offset="1"/>
                                                                                                    </LinearGradientBrush>
                                                                                                </Border.Background>
                                                                                                <TextBlock Foreground="White" FontSize="10" FontWeight="Bold" VerticalAlignment="Center">
                                                                                                    <Run Text="Lv."/><Run Text="{Binding OldLevel}"/>
                                                                                                    <Run Text=" → "/><Run Text="{Binding NewLevel}"/>
                                                                                                </TextBlock>
                                                                                            </Border>
                                                                                        </Grid>
                                                                                    </Border>
                                                                                </DataTemplate>
                                                                            </ItemsControl.ItemTemplate>
                                                                        </ItemsControl>
                                                                    </StackPanel>
                                                                </Border>
                                                            </DataTemplate>
                                                        </ItemsControl.ItemTemplate>
                                                    </ItemsControl>
                                                    <TextBlock x:Name="NoHexaSkillDataText" Text="6차 스킬 강화 기록이 없습니다."
                                                               Foreground="{DynamicResource TextMuted}" FontSize="13" 
                                                               HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="Collapsed"/>
                                                </Grid>
                                            </ScrollViewer>
                                        </Grid>
                                    </Border>
                                </StackPanel>
                            </Grid>


                    <Popup x:Name="ItemTooltipPopup"
                           DataContext="{x:Null}"
                           Placement="Absolute"
                           AllowsTransparency="True"
                           StaysOpen="True"
                           PopupAnimation="None"
                           Focusable="False">
                        <Border Background="Transparent" BorderThickness="0" Padding="4">
                            <Grid MinWidth="10" MinHeight="10"
                                  RenderOptions.BitmapScalingMode="NearestNeighbor">
                                <Image x:Name="PopupTooltipImage"
                                       Source="{Binding Converter={StaticResource ItemTooltipImageConverter}}"
                                       RenderOptions.BitmapScalingMode="NearestNeighbor"
                                       Stretch="None"
                                       HorizontalAlignment="Center"
                                       VerticalAlignment="Center">
                                    <Image.Style>
                                        <Style TargetType="Image">
                                            <Setter Property="Visibility" Value="Collapsed"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding ItemInfoJson, Converter={StaticResource StringNotEmptyToBoolConverter}}" Value="True">
                                                    <Setter Property="Visibility" Value="Visible"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Image.Style>
                                </Image>
                                <ContentControl x:Name="PopupTooltipFallback"
                                                Content="{Binding ItemInfoJson, Converter={StaticResource JsonToItemInfoConverter}}"
                                                ContentTemplate="{StaticResource ItemTooltipTemplate}">
                                    <ContentControl.Style>
                                        <Style TargetType="ContentControl">
                                            <Setter Property="Visibility" Value="Collapsed"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding ElementName=PopupTooltipImage, Path=Source}" Value="{x:Null}">
                                                    <Setter Property="Visibility" Value="Visible"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </ContentControl.Style>
                                </ContentControl>
                            </Grid>
                        </Border>
                    </Popup>

                    <Popup x:Name="SkillTooltipPopup"
                           Placement="MousePoint"
                           AllowsTransparency="True"
                           StaysOpen="True"
                           PopupAnimation="None"
                           Focusable="False">
                        <Border Background="Transparent" BorderThickness="0" Padding="0" IsHitTestVisible="False">
                            <Image x:Name="SkillTooltipImage" 
                                   Stretch="None" 
                                   RenderOptions.BitmapScalingMode="NearestNeighbor"
                                   IsHitTestVisible="False"/>
                        </Border>
                    </Popup>

                    <Border x:Name="NoDataPanel" Style="{StaticResource ModernCard}" Margin="0,24,0,0" Visibility="Collapsed">
                        <StackPanel HorizontalAlignment="Center" Margin="20">
                            <Border Background="#1A5AC8FA" Width="80" Height="80" CornerRadius="40" Margin="0,0,0,20">
                                <ui:SymbolIcon Symbol="Info24" FontSize="36" Foreground="{DynamicResource AccentCyan}"/>
                            </Border>
                            <TextBlock Text="데이터가 없습니다" Foreground="{DynamicResource TextPrimary}" FontSize="18" FontWeight="SemiBold" 
                                       HorizontalAlignment="Center"/>
                            <TextBlock Text="프로그램을 사용하면서 숙제를 완료하면&#x0a;자동으로 통계가 수집됩니다." 
                                       Foreground="{DynamicResource TextSecondary}" FontSize="13" TextAlignment="Center" Margin="0,12,0,0"/>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </ScrollViewer>
        </Grid>
    </Grid>
</ui:FluentWindow>
