<Window x:Class="MapleHomework.CharacterSearchWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
        xmlns:converters="clr-namespace:MapleHomework.Converters"
        Title="캐릭터 검색"
        Width="1150" Height="750"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        WindowStartupLocation="CenterScreen"
        ResizeMode="NoResize">

    <Window.Resources>
        <converters:RateToWidthConverter x:Key="RateToWidthConverter"/>
        
        <!-- 장비 슬롯 스타일 (메이플 이미지 기반) -->
        <Style x:Key="EquipSlotStyle" TargetType="Grid">
            <Setter Property="Width" Value="38"/>
            <Setter Property="Height" Value="38"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Margin" Value="1"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Effect">
                        <Setter.Value>
                            <DropShadowEffect Color="#5AC8FA" BlurRadius="8" ShadowDepth="0" Opacity="0.6"/>
                        </Setter.Value>
                    </Setter>
                </Trigger>
            </Style.Triggers>
        </Style>
        
        <Style x:Key="PresetButtonStyle" TargetType="Border">
            <Setter Property="Width" Value="32"/>
            <Setter Property="Height" Value="24"/>
            <Setter Property="CornerRadius" Value="4"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Background" Value="#4A5A6A"/>
            <Setter Property="BorderBrush" Value="#6A7A8A"/>
            <Setter Property="BorderThickness" Value="1"/>
        </Style>

        <!-- 글래스 카드 스타일 -->
        <Style x:Key="GlassCard" TargetType="Border">
            <Setter Property="CornerRadius" Value="16"/>
            <Setter Property="Background" Value="#12FFFFFF"/>
            <Setter Property="BorderBrush" Value="#18FFFFFF"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect BlurRadius="20" ShadowDepth="0" Opacity="0.15"/>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Grid>
        <!-- 외곽 클리핑용 Border -->
        <Border Margin="10" CornerRadius="20" ClipToBounds="True">
        <!-- 메인 컨테이너 -->
        <Border x:Name="MainContainer" CornerRadius="20" 
                RenderOptions.EdgeMode="Aliased"
                SnapsToDevicePixels="True">
        <Border.Background>
            <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                <GradientStop Color="#FF1a1a2e" Offset="0"/>
                <GradientStop Color="#FF16213e" Offset="0.5"/>
                <GradientStop Color="#FF0f0f23" Offset="1"/>
            </LinearGradientBrush>
        </Border.Background>
        <Border.Effect>
            <DropShadowEffect BlurRadius="50" ShadowDepth="0" Opacity="0.5" Color="#000000"/>
        </Border.Effect>

        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="56"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- 타이틀바 -->
            <Border x:Name="TitleBar" Grid.Row="0" CornerRadius="20,20,0,0" MouseLeftButtonDown="TitleBar_MouseLeftButtonDown">
                <Border.Background>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                        <GradientStop Color="#20FFFFFF" Offset="0"/>
                        <GradientStop Color="#08FFFFFF" Offset="1"/>
                    </LinearGradientBrush>
                </Border.Background>
                <Grid Margin="24,0">
                    <!-- 로고 + 타이틀 -->
                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                        <Border Width="32" Height="32" CornerRadius="8">
                            <Border.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                    <GradientStop Color="#667eea" Offset="0"/>
                                    <GradientStop Color="#764ba2" Offset="1"/>
                                </LinearGradientBrush>
                            </Border.Background>
                            <ui:SymbolIcon Symbol="PersonSearch24" FontSize="16" Foreground="White"/>
                        </Border>
                        <TextBlock x:Name="TitleText" Text="CHARACTER LOOKUP" Foreground="#E0E0E0" FontSize="14" 
                                   FontWeight="SemiBold" VerticalAlignment="Center" Margin="12,0,0,0" Opacity="0.9"/>
                    </StackPanel>
                    
                    <!-- 우측 버튼들 -->
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Center">
                        <Button Click="CloseButton_Click" Width="40" Height="40" Padding="0" 
                                Background="Transparent" BorderThickness="0" Cursor="Hand">
                            <Border Width="32" Height="32" CornerRadius="8" Background="#10FFFFFF">
                                <ui:SymbolIcon Symbol="Dismiss24" FontSize="14" Foreground="#A0A0A0"/>
                            </Border>
                        </Button>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- 메인 콘텐츠 -->
            <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
                <Grid Margin="28,20,28,28">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- 검색 바 -->
                    <Border x:Name="SearchCard" Grid.Row="0" Style="{StaticResource GlassCard}" Padding="8" Margin="0,0,0,16">
                        <Grid Height="44">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            
                            <Border Grid.Column="0" CornerRadius="10" Background="#08FFFFFF">
                                <Grid>
                                    <ui:SymbolIcon Symbol="Search24" FontSize="16" Foreground="#505070" 
                                                   HorizontalAlignment="Left" VerticalAlignment="Center" Margin="14,0,0,0"/>
                                    <TextBox x:Name="SearchTextBox" FontSize="14" Padding="40,10,14,10"
                                             Background="Transparent" Foreground="#E8E8F0" 
                                             BorderThickness="0" VerticalContentAlignment="Center"
                                             KeyDown="SearchTextBox_KeyDown" CaretBrush="#667eea">
                                        <TextBox.Style>
                                            <Style TargetType="TextBox">
                                                <Setter Property="Template">
                                                    <Setter.Value>
                                                        <ControlTemplate TargetType="TextBox">
                                                            <Grid>
                                                                <TextBlock x:Name="Placeholder" Text="캐릭터 닉네임 검색..." 
                                                                           Foreground="#505070" VerticalAlignment="Center"
                                                                           Margin="40,0,0,0" Visibility="Collapsed" FontSize="14"/>
                                                                <ScrollViewer x:Name="PART_ContentHost" VerticalAlignment="Center"/>
                                                            </Grid>
                                                            <ControlTemplate.Triggers>
                                                                <Trigger Property="Text" Value="">
                                                                    <Setter TargetName="Placeholder" Property="Visibility" Value="Visible"/>
                                                                </Trigger>
                                                            </ControlTemplate.Triggers>
                                                        </ControlTemplate>
                                                    </Setter.Value>
                                                </Setter>
                                            </Style>
                                        </TextBox.Style>
                                    </TextBox>
                                </Grid>
                            </Border>
                            
                            <Button x:Name="SearchButton" Grid.Column="1" Click="SearchButton_Click" 
                                    Margin="8,0,0,0" Cursor="Hand" Width="100">
                                <Button.Style>
                                    <Style TargetType="Button">
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="Button">
                                                    <Border x:Name="Bd" CornerRadius="10" Padding="16,10">
                                                        <Border.Background>
                                                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                                                <GradientStop Color="#667eea" Offset="0"/>
                                                                <GradientStop Color="#764ba2" Offset="1"/>
                                                            </LinearGradientBrush>
                                                        </Border.Background>
                                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                                                            <ui:SymbolIcon Symbol="Search24" FontSize="14" Foreground="White" Margin="0,0,6,0"/>
                                                            <TextBlock Text="검색" Foreground="White" FontSize="13" FontWeight="SemiBold"/>
                                                        </StackPanel>
                                                    </Border>
                                                    <ControlTemplate.Triggers>
                                                        <Trigger Property="IsMouseOver" Value="True">
                                                            <Setter TargetName="Bd" Property="Opacity" Value="0.9"/>
                                                        </Trigger>
                                                    </ControlTemplate.Triggers>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </Style>
                                </Button.Style>
                            </Button>
                        </Grid>
                    </Border>

                    <!-- 로딩 -->
                    <Border x:Name="LoadingPanel" Grid.Row="1" Visibility="Collapsed" Margin="0,80">
                        <StackPanel HorizontalAlignment="Center">
                            <Border Width="64" Height="64" CornerRadius="32">
                                <Border.Background>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                        <GradientStop Color="#667eea" Offset="0"/>
                                        <GradientStop Color="#764ba2" Offset="1"/>
                                    </LinearGradientBrush>
                                </Border.Background>
                                <ui:ProgressRing IsIndeterminate="True" Width="32" Height="32" Foreground="White"/>
                            </Border>
                            <TextBlock x:Name="LoadingText" Text="캐릭터 정보를 불러오는 중..." 
                                       Foreground="#808090" FontSize="14" Margin="0,20,0,0" HorizontalAlignment="Center"/>
                        </StackPanel>
                    </Border>

                    <!-- 결과 영역 -->
                    <Grid x:Name="ResultPanel" Grid.Row="1" Grid.RowSpan="2" Visibility="Collapsed">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <!-- 상단: 프로필 + EXP TREND (2열) -->
                        <Grid Grid.Row="0" Margin="0,0,0,14">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="340"/>
                            </Grid.ColumnDefinitions>

                            <!-- 왼쪽: 캐릭터 프로필 -->
                            <Border x:Name="ProfileCard" Grid.Column="0" Style="{StaticResource GlassCard}" Padding="16" Margin="0,0,14,0">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>

                                    <!-- 캐릭터 이미지 -->
                                    <Border Grid.Column="0" Width="80" Height="80" CornerRadius="10" ClipToBounds="True" Margin="0,0,16,0">
                                        <Border.Background>
                                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                                <GradientStop Color="#20667eea" Offset="0"/>
                                                <GradientStop Color="#20764ba2" Offset="1"/>
                                            </LinearGradientBrush>
                                        </Border.Background>
                                        <Image x:Name="CharacterImage" Stretch="Uniform" RenderOptions.BitmapScalingMode="Fant"
                                               RenderTransformOrigin="0.5,0.5">
                                            <Image.RenderTransform>
                                                <ScaleTransform ScaleX="1.4" ScaleY="1.4"/>
                                            </Image.RenderTransform>
                                        </Image>
                                    </Border>

                                    <!-- 캐릭터 정보 -->
                                    <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,4">
                                            <TextBlock x:Name="CharacterName" Text="-" Foreground="#F0F0F8" 
                                                       FontSize="20" FontWeight="Bold"/>
                                            <Border Padding="8,3" CornerRadius="6" Margin="10,0,0,0" VerticalAlignment="Center">
                                                <Border.Background>
                                                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                                        <GradientStop Color="#667eea" Offset="0"/>
                                                        <GradientStop Color="#764ba2" Offset="1"/>
                                                    </LinearGradientBrush>
                                                </Border.Background>
                                                <StackPanel Orientation="Horizontal">
                                                    <TextBlock Text="Lv." Foreground="White" FontSize="12" FontWeight="Bold"/>
                                                    <TextBlock x:Name="CharacterLevel" Text="-" Foreground="White" FontSize="12" FontWeight="Bold"/>
                                                </StackPanel>
                                            </Border>
                                        </StackPanel>
                                        <TextBlock x:Name="CharacterClass" Text="-" Foreground="#808090" FontSize="13" Margin="0,0,0,8"/>
                                        
                                        <!-- 스탯 행 -->
                                        <StackPanel Orientation="Horizontal">
                                            <Border Padding="10,6" CornerRadius="6" Background="#10FFFFFF" Margin="0,0,8,0">
                                                <StackPanel>
                                                    <TextBlock x:Name="LabelWorld" Text="WORLD" Foreground="#606070" FontSize="10" FontWeight="SemiBold"/>
                                                    <TextBlock x:Name="WorldText" Text="-" Foreground="#60a5fa" FontSize="13" FontWeight="Bold" Margin="0,2,0,0"/>
                                                </StackPanel>
                                            </Border>
                                            <Border Padding="10,6" CornerRadius="6" Background="#10FFFFFF">
                                                <StackPanel>
                                                    <TextBlock x:Name="LabelGuild" Text="GUILD" Foreground="#606070" FontSize="10" FontWeight="SemiBold"/>
                                                    <TextBlock x:Name="GuildText" Text="-" Foreground="#34d399" FontSize="13" FontWeight="Bold" Margin="0,2,0,0"/>
                                                </StackPanel>
                                            </Border>
                                        </StackPanel>
                                    </StackPanel>

                                    <!-- 우측: 전투력 + 유니온 -->
                                    <StackPanel Grid.Column="2" VerticalAlignment="Center" HorizontalAlignment="Right">
                                        <Border Padding="14,8" CornerRadius="10" Margin="0,0,0,6">
                                            <Border.Background>
                                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                                    <GradientStop Color="#15ff9f43" Offset="0"/>
                                                    <GradientStop Color="#10feca57" Offset="1"/>
                                                </LinearGradientBrush>
                                            </Border.Background>
                                            <StackPanel>
                                                <TextBlock x:Name="LabelCombatPower" Text="COMBAT POWER" Foreground="#a08060" FontSize="10" FontWeight="SemiBold"/>
                                                <TextBlock x:Name="CombatPowerText" Text="-" FontSize="18" FontWeight="Bold" Margin="0,2,0,0">
                                                    <TextBlock.Foreground>
                                                        <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                                            <GradientStop Color="#FF9F43" Offset="0"/>
                                                            <GradientStop Color="#FECA57" Offset="1"/>
                                                        </LinearGradientBrush>
                                                    </TextBlock.Foreground>
                                                </TextBlock>
                                            </StackPanel>
                                        </Border>
                                        <Border Padding="14,6" CornerRadius="10">
                                            <Border.Background>
                                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                                    <GradientStop Color="#15a78bfa" Offset="0"/>
                                                    <GradientStop Color="#10c4b5fd" Offset="1"/>
                                                </LinearGradientBrush>
                                            </Border.Background>
                                            <StackPanel>
                                                <TextBlock x:Name="LabelUnion" Text="UNION" Foreground="#8070a0" FontSize="10" FontWeight="SemiBold"/>
                                                <TextBlock x:Name="UnionLevelText" Text="-" Foreground="#a78bfa" FontSize="15" FontWeight="Bold" Margin="0,2,0,0"/>
                                            </StackPanel>
                                        </Border>
                                    </StackPanel>
                                </Grid>
                            </Border>

                            <!-- 오른쪽: EXP TREND (막대 그래프) -->
                            <Border x:Name="ExpCard" Grid.Column="1" Style="{StaticResource GlassCard}" Padding="14">
                                <Grid>
                                    <StackPanel x:Name="ExpContentPanel" Visibility="Collapsed">
                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                                            <Border Padding="8,4" CornerRadius="6">
                                                <Border.Background>
                                                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                                        <GradientStop Color="#10b981" Offset="0"/>
                                                        <GradientStop Color="#34d399" Offset="1"/>
                                                    </LinearGradientBrush>
                                                </Border.Background>
                                                <StackPanel Orientation="Horizontal">
                                                    <ui:SymbolIcon Symbol="ArrowTrendingLines24" FontSize="12" Foreground="White" Margin="0,0,5,0"/>
                                                    <TextBlock Text="EXP TREND" Foreground="White" FontSize="11" FontWeight="Bold"/>
                                                </StackPanel>
                                            </Border>
                                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="12,0,0,0">
                                                <TextBlock x:Name="LabelAvgExp" Text="일평균 " Foreground="#707080" FontSize="12"/>
                                                <TextBlock x:Name="AvgExpText" Text="-" Foreground="#10b981" FontSize="14" FontWeight="Bold"/>
                                                <TextBlock x:Name="AvgExpAmount" Text="" Foreground="#606070" FontSize="11" 
                                                           VerticalAlignment="Bottom" Margin="5,0,0,1"/>
                                            </StackPanel>
                                        </StackPanel>
                                        
                                        <!-- 막대 그래프 -->
                                        <Grid Height="70">
                                            <ItemsControl x:Name="ExpGraphList">
                                                <ItemsControl.ItemsPanel>
                                                    <ItemsPanelTemplate>
                                                        <StackPanel Orientation="Horizontal" VerticalAlignment="Bottom"/>
                                                    </ItemsPanelTemplate>
                                                </ItemsControl.ItemsPanel>
                                                <ItemsControl.ItemTemplate>
                                                    <DataTemplate>
                                                        <StackPanel Width="40" Margin="2,0" VerticalAlignment="Bottom">
                                                            <TextBlock Text="{Binding ExpRateText}" Foreground="#10b981" FontSize="10" 
                                                                       FontWeight="Bold" HorizontalAlignment="Center" Margin="0,0,0,3"/>
                                                            <Border Width="24" CornerRadius="3,3,0,0" HorizontalAlignment="Center"
                                                                    Height="{Binding GraphRate, Converter={StaticResource RateToWidthConverter}, ConverterParameter=40}">
                                                                <Border.Background>
                                                                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                                                        <GradientStop Color="#34d399" Offset="0"/>
                                                                        <GradientStop Color="#10b981" Offset="1"/>
                                                                    </LinearGradientBrush>
                                                                </Border.Background>
                                                            </Border>
                                                            <TextBlock Text="{Binding DateLabel}" Foreground="#707080" 
                                                                       FontSize="10" HorizontalAlignment="Center" Margin="0,3,0,0"/>
                                                        </StackPanel>
                                                    </DataTemplate>
                                                </ItemsControl.ItemTemplate>
                                            </ItemsControl>
                                        </Grid>
                                    </StackPanel>
                                    
                                    <!-- 로딩 -->
                                    <StackPanel x:Name="ExpLoadingPanel" Visibility="Visible" Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                                        <Border Width="28" Height="28" CornerRadius="14" Margin="0,0,10,0">
                                            <Border.Background>
                                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                                    <GradientStop Color="#10b981" Offset="0"/>
                                                    <GradientStop Color="#34d399" Offset="1"/>
                                                </LinearGradientBrush>
                                            </Border.Background>
                                            <ui:ProgressRing IsIndeterminate="True" Width="16" Height="16" Foreground="White"/>
                                        </Border>
                                        <StackPanel VerticalAlignment="Center">
                                            <TextBlock x:Name="ExpLoadingText1" Text="경험치 수집 중..." Foreground="#10b981" FontSize="12" FontWeight="SemiBold"/>
                                            <TextBlock x:Name="ExpLoadingText2" Text="7일 데이터 분석" Foreground="#606070" FontSize="10"/>
                                        </StackPanel>
                                    </StackPanel>
                                </Grid>
                            </Border>
                        </Grid>

                        <!-- 하단: 장비 | 헥사코어 -->
                        <Grid Grid.Row="1">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <!-- 왼쪽: 장비창 (메이플 스타일) -->
                            <Border x:Name="EquipmentCard" Grid.Column="0" CornerRadius="8" Margin="0,0,16,0" 
                                    Background="#3D4856" BorderBrush="#4D5866" BorderThickness="1">
                                <Grid Width="240">
                                    <!-- 장비창 헤더 -->
                                    <Border CornerRadius="8,8,0,0" Height="36" VerticalAlignment="Top" Background="#4D5866">
                                        <TextBlock x:Name="EquipmentHeaderText" Text="EQUIPMENT" Foreground="#C0C8D0" FontSize="11" FontWeight="Bold" 
                                                   VerticalAlignment="Center" Margin="14,0,0,0"/>
                                    </Border>
                                    
                                    <!-- 장비 그리드 -->
                                    <Grid Margin="14,44,14,14">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="42"/>
                                            <RowDefinition Height="42"/>
                                            <RowDefinition Height="42"/>
                                            <RowDefinition Height="42"/>
                                            <RowDefinition Height="42"/>
                                            <RowDefinition Height="42"/>
                                            <RowDefinition Height="8"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="42"/>
                                            <ColumnDefinition Width="42"/>
                                            <ColumnDefinition Width="42"/>
                                            <ColumnDefinition Width="42"/>
                                            <ColumnDefinition Width="42"/>
                                        </Grid.ColumnDefinitions>
                                        
                                        <!-- 1행: Ring3, Face, (빈칸 삭제), Hat, Cape -->
                                        <Grid x:Name="Slot_Ring3" Grid.Row="0" Grid.Column="0" Style="{StaticResource EquipSlotStyle}" MouseEnter="EquipSlot_MouseEnter" MouseLeave="EquipSlot_MouseLeave">
                                            <Image Source="/Data/EquipTab.Slots.png" Stretch="Fill"/>
                                        </Grid>
                                        <Grid x:Name="Slot_Face" Grid.Row="0" Grid.Column="1" Style="{StaticResource EquipSlotStyle}" MouseEnter="EquipSlot_MouseEnter" MouseLeave="EquipSlot_MouseLeave">
                                            <Image Source="/Data/EquipTab.Slots.png" Stretch="Fill"/>
                                        </Grid>
                                        <!-- 3열 1행 삭제됨 -->
                                        <Grid x:Name="Slot_Hat" Grid.Row="0" Grid.Column="3" Style="{StaticResource EquipSlotStyle}" MouseEnter="EquipSlot_MouseEnter" MouseLeave="EquipSlot_MouseLeave">
                                            <Image Source="/Data/EquipTab.Slots.png" Stretch="Fill"/>
                                        </Grid>
                                        <Grid x:Name="Slot_Cape" Grid.Row="0" Grid.Column="4" Style="{StaticResource EquipSlotStyle}" MouseEnter="EquipSlot_MouseEnter" MouseLeave="EquipSlot_MouseLeave">
                                            <Image Source="/Data/EquipTab.Slots.png" Stretch="Fill"/>
                                        </Grid>
                                        
                                        <!-- 2행 -->
                                        <Grid x:Name="Slot_Ring2" Grid.Row="1" Grid.Column="0" Style="{StaticResource EquipSlotStyle}" MouseEnter="EquipSlot_MouseEnter" MouseLeave="EquipSlot_MouseLeave">
                                            <Image Source="/Data/EquipTab.Slots.png" Stretch="Fill"/>
                                        </Grid>
                                        <Grid x:Name="Slot_Eye" Grid.Row="1" Grid.Column="1" Style="{StaticResource EquipSlotStyle}" MouseEnter="EquipSlot_MouseEnter" MouseLeave="EquipSlot_MouseLeave">
                                            <Image Source="/Data/EquipTab.Slots.png" Stretch="Fill"/>
                                        </Grid>
                                        <Grid x:Name="Slot_Weapon" Grid.Row="1" Grid.Column="2" Style="{StaticResource EquipSlotStyle}" MouseEnter="EquipSlot_MouseEnter" MouseLeave="EquipSlot_MouseLeave">
                                            <Image Source="/Data/EquipTab.Slots.png" Stretch="Fill"/>
                                        </Grid>
                                        <Grid x:Name="Slot_Top" Grid.Row="1" Grid.Column="3" Style="{StaticResource EquipSlotStyle}" MouseEnter="EquipSlot_MouseEnter" MouseLeave="EquipSlot_MouseLeave">
                                            <Image Source="/Data/EquipTab.Slots.png" Stretch="Fill"/>
                                        </Grid>
                                        <Grid x:Name="Slot_Glove" Grid.Row="1" Grid.Column="4" Style="{StaticResource EquipSlotStyle}" MouseEnter="EquipSlot_MouseEnter" MouseLeave="EquipSlot_MouseLeave">
                                            <Image Source="/Data/EquipTab.Slots.png" Stretch="Fill"/>
                                        </Grid>
                                        
                                        <!-- 3행 -->
                                        <Grid x:Name="Slot_Ring1" Grid.Row="2" Grid.Column="0" Style="{StaticResource EquipSlotStyle}" MouseEnter="EquipSlot_MouseEnter" MouseLeave="EquipSlot_MouseLeave">
                                            <Image Source="/Data/EquipTab.Slots.png" Stretch="Fill"/>
                                        </Grid>
                                        <Grid x:Name="Slot_Earring" Grid.Row="2" Grid.Column="1" Style="{StaticResource EquipSlotStyle}" MouseEnter="EquipSlot_MouseEnter" MouseLeave="EquipSlot_MouseLeave">
                                            <Image Source="/Data/EquipTab.Slots.png" Stretch="Fill"/>
                                        </Grid>
                                        <Grid x:Name="Slot_SubWeapon" Grid.Row="2" Grid.Column="2" Style="{StaticResource EquipSlotStyle}" MouseEnter="EquipSlot_MouseEnter" MouseLeave="EquipSlot_MouseLeave">
                                            <Image Source="/Data/EquipTab.Slots.png" Stretch="Fill"/>
                                        </Grid>
                                        <Grid x:Name="Slot_Bottom" Grid.Row="2" Grid.Column="3" Style="{StaticResource EquipSlotStyle}" MouseEnter="EquipSlot_MouseEnter" MouseLeave="EquipSlot_MouseLeave">
                                            <Image Source="/Data/EquipTab.Slots.png" Stretch="Fill"/>
                                        </Grid>
                                        <Grid x:Name="Slot_Shoes" Grid.Row="2" Grid.Column="4" Style="{StaticResource EquipSlotStyle}" MouseEnter="EquipSlot_MouseEnter" MouseLeave="EquipSlot_MouseLeave">
                                            <Image Source="/Data/EquipTab.Slots.png" Stretch="Fill"/>
                                        </Grid>
                                        
                                        <!-- 4행 -->
                                        <Grid x:Name="Slot_Ring0" Grid.Row="3" Grid.Column="0" Style="{StaticResource EquipSlotStyle}" MouseEnter="EquipSlot_MouseEnter" MouseLeave="EquipSlot_MouseLeave">
                                            <Image Source="/Data/EquipTab.Slots.png" Stretch="Fill"/>
                                        </Grid>
                                        <Grid x:Name="Slot_Pendant1" Grid.Row="3" Grid.Column="1" Style="{StaticResource EquipSlotStyle}" MouseEnter="EquipSlot_MouseEnter" MouseLeave="EquipSlot_MouseLeave">
                                            <Image Source="/Data/EquipTab.Slots.png" Stretch="Fill"/>
                                        </Grid>
                                        <Grid x:Name="Slot_Emblem" Grid.Row="3" Grid.Column="2" Style="{StaticResource EquipSlotStyle}" MouseEnter="EquipSlot_MouseEnter" MouseLeave="EquipSlot_MouseLeave">
                                            <Image Source="/Data/EquipTab.Slots.png" Stretch="Fill"/>
                                        </Grid>
                                        <Grid x:Name="Slot_Shoulder" Grid.Row="3" Grid.Column="3" Style="{StaticResource EquipSlotStyle}" MouseEnter="EquipSlot_MouseEnter" MouseLeave="EquipSlot_MouseLeave">
                                            <Image Source="/Data/EquipTab.Slots.png" Stretch="Fill"/>
                                        </Grid>
                                        <Grid x:Name="Slot_Medal" Grid.Row="3" Grid.Column="4" Style="{StaticResource EquipSlotStyle}" MouseEnter="EquipSlot_MouseEnter" MouseLeave="EquipSlot_MouseLeave">
                                            <Image Source="/Data/EquipTab.Slots.png" Stretch="Fill"/>
                                        </Grid>
                                        
                                        <!-- 5행 -->
                                        <Grid x:Name="Slot_Belt" Grid.Row="4" Grid.Column="0" Style="{StaticResource EquipSlotStyle}" MouseEnter="EquipSlot_MouseEnter" MouseLeave="EquipSlot_MouseLeave">
                                            <Image Source="/Data/EquipTab.Slots.png" Stretch="Fill"/>
                                        </Grid>
                                        <Grid x:Name="Slot_Pendant0" Grid.Row="4" Grid.Column="1" Style="{StaticResource EquipSlotStyle}" MouseEnter="EquipSlot_MouseEnter" MouseLeave="EquipSlot_MouseLeave">
                                            <Image Source="/Data/EquipTab.Slots.png" Stretch="Fill"/>
                                        </Grid>
                                        <!-- 3열 5행 삭제됨 -->
                                        <Grid x:Name="Slot_Android" Grid.Row="4" Grid.Column="3" Style="{StaticResource EquipSlotStyle}" MouseEnter="EquipSlot_MouseEnter" MouseLeave="EquipSlot_MouseLeave">
                                            <Image Source="/Data/EquipTab.Slots.png" Stretch="Fill"/>
                                        </Grid>
                                        <Grid x:Name="Slot_Heart" Grid.Row="4" Grid.Column="4" Style="{StaticResource EquipSlotStyle}" MouseEnter="EquipSlot_MouseEnter" MouseLeave="EquipSlot_MouseLeave">
                                            <Image Source="/Data/EquipTab.Slots.png" Stretch="Fill"/>
                                        </Grid>
                                        
                                        <!-- 6행: Pocket만 남김 (2,3,4,5열 삭제됨) -->
                                        <Grid x:Name="Slot_Pocket" Grid.Row="5" Grid.Column="0" Style="{StaticResource EquipSlotStyle}" MouseEnter="EquipSlot_MouseEnter" MouseLeave="EquipSlot_MouseLeave">
                                            <Image Source="/Data/EquipTab.Slots.png" Stretch="Fill"/>
                                        </Grid>
                                        
                                        <!-- 프리셋 -->
                                        <StackPanel Grid.Row="7" Grid.ColumnSpan="5" Orientation="Horizontal" HorizontalAlignment="Left">
                                            <TextBlock x:Name="PresetsLabel" Text="PRESET" Foreground="#8090A0" FontSize="10" 
                                                       FontWeight="SemiBold" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                            <Border x:Name="Preset1Border" Style="{StaticResource PresetButtonStyle}" 
                                                    MouseLeftButtonDown="Preset1_Click" Margin="0,0,4,0"
                                                    Background="#5AA0E0" BorderBrush="#6AB0F0">
                                                <TextBlock Text="1" Foreground="White" FontSize="10" FontWeight="Bold"
                                                           HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Border>
                                            <Border x:Name="Preset2Border" Style="{StaticResource PresetButtonStyle}" 
                                                    MouseLeftButtonDown="Preset2_Click" Margin="0,0,4,0">
                                                <TextBlock Text="2" Foreground="#A0B0C0" FontSize="10" FontWeight="Bold"
                                                           HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Border>
                                            <Border x:Name="Preset3Border" Style="{StaticResource PresetButtonStyle}" 
                                                    MouseLeftButtonDown="Preset3_Click">
                                                <TextBlock Text="3" Foreground="#A0B0C0" FontSize="10" FontWeight="Bold"
                                                           HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Border>
                                        </StackPanel>
                                    </Grid>
                                </Grid>
                            </Border>

                            <!-- 오른쪽: HEXA CORE + HEXA STAT -->
                            <Border x:Name="HexaCoreCard" Grid.Column="1" Style="{StaticResource GlassCard}" Padding="16">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <!-- 좌측: HEXA CORE 스킬들 -->
                                    <StackPanel Grid.Column="0">
                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,14">
                                            <Border Padding="10,5" CornerRadius="6">
                                                <Border.Background>
                                                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                                        <GradientStop Color="#7c3aed" Offset="0"/>
                                                        <GradientStop Color="#a855f7" Offset="1"/>
                                                    </LinearGradientBrush>
                                                </Border.Background>
                                                <StackPanel Orientation="Horizontal">
                                                    <Image Source="/Data/hexa.png" Width="14" Height="14" Margin="0,0,6,0"/>
                                                    <TextBlock Text="HEXA CORE" Foreground="White" FontSize="12" FontWeight="Bold"/>
                                                </StackPanel>
                                            </Border>
                                        </StackPanel>
                                        
                                        <ItemsControl x:Name="HexaCoreList">
                                            <ItemsControl.ItemsPanel>
                                                <ItemsPanelTemplate>
                                                    <WrapPanel Orientation="Horizontal"/>
                                                </ItemsPanelTemplate>
                                            </ItemsControl.ItemsPanel>
                                            <ItemsControl.ItemTemplate>
                                                <DataTemplate>
                                                    <Border Margin="4" CornerRadius="10" Width="72" Height="80"
                                                            ToolTip="{Binding OriginalName}" ToolTipService.InitialShowDelay="0"
                                                            Background="#10FFFFFF" BorderBrush="#18FFFFFF" BorderThickness="1">
                                                        <Grid>
                                                            <Grid Width="54" Height="54" HorizontalAlignment="Center" VerticalAlignment="Top" Margin="0,8,0,0">
                                                                <Image Source="{Binding BadgeIconPath}" Width="54" Height="54" Opacity="0.95"/>
                                                                <Image Source="{Binding SkillIconUrl}" Width="26" Height="26" 
                                                                       HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                                <Border HorizontalAlignment="Right" VerticalAlignment="Bottom" CornerRadius="5" Padding="4,2">
                                                                    <Border.Background>
                                                                        <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                                                            <GradientStop Color="#7c3aed" Offset="0"/>
                                                                            <GradientStop Color="#a855f7" Offset="1"/>
                                                                        </LinearGradientBrush>
                                                                    </Border.Background>
                                                                    <TextBlock Foreground="White" FontSize="10" FontWeight="Bold">
                                                                        <Run Text="Lv."/><Run Text="{Binding CoreLevel}"/>
                                                                    </TextBlock>
                                                                </Border>
                                                            </Grid>
                                                        </Grid>
                                                    </Border>
                                                </DataTemplate>
                                            </ItemsControl.ItemTemplate>
                                        </ItemsControl>
                                        
                                        <TextBlock x:Name="NoHexaText" Text="HEXA 코어 정보 없음" 
                                                   Foreground="#606070" FontSize="13" Margin="0,14,0,0" Visibility="Collapsed"/>
                                    </StackPanel>
                                    
                                    <!-- 우측: HEXA STAT -->
                                    <ItemsControl x:Name="HexaStatList" Grid.Column="1" Visibility="Collapsed" Margin="16,0,0,0">
                                        <ItemsControl.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <StackPanel Orientation="Vertical"/>
                                            </ItemsPanelTemplate>
                                        </ItemsControl.ItemsPanel>
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <Border Margin="0,0,0,10" CornerRadius="10" Padding="12" Width="190"
                                                        Background="#10FFFFFF" BorderBrush="#18FFFFFF" BorderThickness="1">
                                                    <Grid>
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="Auto"/>
                                                            <ColumnDefinition Width="*"/>
                                                        </Grid.ColumnDefinitions>
                                                        
                                                        <Border Grid.Column="0" Width="24" Height="24" CornerRadius="6" Margin="0,0,10,0" VerticalAlignment="Top">
                                                            <Border.Background>
                                                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                                                    <GradientStop Color="#ec4899" Offset="0"/>
                                                                    <GradientStop Color="#f472b6" Offset="1"/>
                                                                </LinearGradientBrush>
                                                            </Border.Background>
                                                            <TextBlock Text="{Binding SlotIndex}" Foreground="White" FontSize="11" FontWeight="Bold"
                                                                       HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                        </Border>
                                                        
                                                        <StackPanel Grid.Column="1">
                                                            <Grid>
                                                                <TextBlock Text="{Binding MainStat}" Foreground="#a78bfa" FontSize="13" FontWeight="SemiBold"/>
                                                                <TextBlock HorizontalAlignment="Right" Foreground="#D0D0E0" FontSize="12" FontWeight="SemiBold">
                                                                    <Run Text="Lv."/><Run Text="{Binding MainLevel}"/>
                                                                </TextBlock>
                                                            </Grid>
                                                            <Grid Margin="0,3,0,0">
                                                                <TextBlock Text="{Binding SubStat1}" Foreground="#808090" FontSize="11"/>
                                                                <TextBlock HorizontalAlignment="Right" Foreground="#808090" FontSize="11">
                                                                    <Run Text="Lv."/><Run Text="{Binding SubLevel1}"/>
                                                                </TextBlock>
                                                            </Grid>
                                                            <Grid Margin="0,2,0,0">
                                                                <TextBlock Text="{Binding SubStat2}" Foreground="#808090" FontSize="11"/>
                                                                <TextBlock HorizontalAlignment="Right" Foreground="#808090" FontSize="11">
                                                                    <Run Text="Lv."/><Run Text="{Binding SubLevel2}"/>
                                                                </TextBlock>
                                                            </Grid>
                                                        </StackPanel>
                                                    </Grid>
                                                </Border>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                </Grid>
                            </Border>
                        </Grid>
                    </Grid>

                    <!-- 에러 -->
                    <Border x:Name="ErrorPanel" Grid.Row="1" Visibility="Collapsed" Margin="0,60" HorizontalAlignment="Center">
                        <Border Padding="24,16" CornerRadius="12" Background="#20f43f5e" BorderBrush="#40f43f5e" BorderThickness="1">
                            <StackPanel Orientation="Horizontal">
                                <ui:SymbolIcon Symbol="ErrorCircle24" FontSize="20" Foreground="#f87171" Margin="0,0,12,0"/>
                                <TextBlock x:Name="ErrorText" Text="" Foreground="#f87171" FontSize="14" VerticalAlignment="Center"/>
                            </StackPanel>
                        </Border>
                    </Border>
                </Grid>
            </ScrollViewer>
        </Grid>
    </Border>
    </Border>

        <!-- 툴팁 (Popup으로 창 밖으로도 표시 가능) -->
        <Popup x:Name="TooltipPopup" Placement="Mouse" AllowsTransparency="True" 
               IsHitTestVisible="False" PopupAnimation="None">
            <Border x:Name="TooltipBorder" CornerRadius="4" 
                    Background="#F0121212" BorderBrush="#666666" BorderThickness="1">
                <Border.Effect>
                    <DropShadowEffect BlurRadius="20" ShadowDepth="4" Opacity="0.8"/>
                </Border.Effect>
                <Image x:Name="TooltipImage" Stretch="None" RenderOptions.BitmapScalingMode="NearestNeighbor"/>
            </Border>
        </Popup>
    </Grid>
</Window>
